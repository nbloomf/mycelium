<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Tests</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="style.css">
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header>
<h1 class="title">Tests</h1>
</header>
<p>This module collects the tests for our proof checker in one place; to run the entire suite use <code>stack test</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="ot">{-# LANGUAGE FlexibleContexts #-}</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">module</span> <span class="dt">Main</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">import</span> <span class="dt">Data.Proxy</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">  ( <span class="dt">Proxy</span>(<span class="fu">..</span>) )</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw">import</span> <span class="dt">System.Exit</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7">  ( exitFailure )</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="kw">import</span> <span class="dt">Test.QuickCheck</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9">  ( <span class="dt">Arbitrary</span>(<span class="fu">..</span>), quickCheckResult, quickCheckWithResult</a>
<a class="sourceLine" id="cb1-10" data-line-number="10">  , maxSize, maxSuccess, <span class="dt">Args</span>, stdArgs, <span class="dt">Testable</span> )</a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="kw">import</span> <span class="dt">Test.QuickCheck.Test</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12">  ( isSuccess )</a>
<a class="sourceLine" id="cb1-13" data-line-number="13"></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="kw">import</span> <span class="dt">Var</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="kw">import</span> <span class="dt">Sub</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="kw">import</span> <span class="dt">Expr</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="kw">import</span> <span class="dt">Type</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="kw">import</span> <span class="dt">Infer</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="kw">import</span> <span class="dt">Jud</span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="kw">import</span> <span class="dt">Proof</span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="kw">import</span> <span class="dt">Module</span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="kw">import</span> <span class="dt">Fancy</span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="kw">import</span> <span class="dt">Parser</span></a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="ot">main ::</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">main <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">  <span class="kw">let</span> args1 <span class="fu">=</span> stdArgs { maxSuccess <span class="fu">=</span> <span class="dv">500</span>, maxSize <span class="fu">=</span> <span class="dv">30</span> }</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">  <span class="kw">let</span> args2 <span class="fu">=</span> stdArgs { maxSuccess <span class="fu">=</span> <span class="dv">200</span>, maxSize <span class="fu">=</span> <span class="dv">20</span> }</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">  <span class="kw">let</span> args3 <span class="fu">=</span> stdArgs { maxSuccess <span class="fu">=</span> <span class="dv">100</span>, maxSize <span class="fu">=</span> <span class="dv">10</span> }</a>
<a class="sourceLine" id="cb2-6" data-line-number="6"></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">  test_Sub args1</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">  test_Expr args3</a>
<a class="sourceLine" id="cb2-9" data-line-number="9">  test_Type args2</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">  test_Infer args2</a>
<a class="sourceLine" id="cb2-11" data-line-number="11">  test_Jud args2</a>
<a class="sourceLine" id="cb2-12" data-line-number="12">  test_Proof args2</a>
<a class="sourceLine" id="cb2-13" data-line-number="13">  test_Module args3</a>
<a class="sourceLine" id="cb2-14" data-line-number="14">  test_Fancy args3</a>
<a class="sourceLine" id="cb2-15" data-line-number="15">  test_Parser args3</a>
<a class="sourceLine" id="cb2-16" data-line-number="16"></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="ot">test ::</span> (<span class="dt">Testable</span> prop) <span class="ot">=&gt;</span> prop <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb2-18" data-line-number="18">test prop <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19">  result <span class="ot">&lt;-</span> quickCheckResult prop</a>
<a class="sourceLine" id="cb2-20" data-line-number="20">  <span class="kw">case</span> isSuccess result <span class="kw">of</span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21">    <span class="dt">True</span> <span class="ot">-&gt;</span> return ()</a>
<a class="sourceLine" id="cb2-22" data-line-number="22">    <span class="dt">False</span> <span class="ot">-&gt;</span> exitFailure</a>
<a class="sourceLine" id="cb2-23" data-line-number="23"></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="ot">testWith ::</span> (<span class="dt">Testable</span> prop) <span class="ot">=&gt;</span> <span class="dt">Args</span> <span class="ot">-&gt;</span> prop <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb2-25" data-line-number="25">testWith args prop <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb2-26" data-line-number="26">  result <span class="ot">&lt;-</span> quickCheckWithResult args prop</a>
<a class="sourceLine" id="cb2-27" data-line-number="27">  <span class="kw">case</span> isSuccess result <span class="kw">of</span></a>
<a class="sourceLine" id="cb2-28" data-line-number="28">    <span class="dt">True</span> <span class="ot">-&gt;</span> return ()</a>
<a class="sourceLine" id="cb2-29" data-line-number="29">    <span class="dt">False</span> <span class="ot">-&gt;</span> exitFailure</a></code></pre></div>
<h2 id="substitutions">Substitutions</h2>
<p>We bundle together substitution tests parameterized on a <code>Proxy</code> type for easy reuse.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb3-1" data-line-number="1">_Sub_properties</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="ot">  ::</span> (<span class="dt">Eq</span> t, <span class="dt">Show</span> t, <span class="dt">Arbitrary</span> t, <span class="dt">Arbitrary</span> (<span class="dt">Var</span> t), <span class="dt">Arbitrary</span> (<span class="dt">Sub</span> t))</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">  <span class="ot">=&gt;</span> <span class="dt">Args</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">_Sub_properties args name p <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">  putStrLn <span class="fu">$</span> <span class="st">&quot;&gt;&gt;&gt;&gt;&gt; Sub properties: &quot;</span> <span class="fu">++</span> name</a>
<a class="sourceLine" id="cb3-6" data-line-number="6"></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">  putStrLn <span class="st">&quot;====&gt; Support of an empty substitution&quot;</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8">  test <span class="fu">$</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9">    test_support_empty_sub p</a>
<a class="sourceLine" id="cb3-10" data-line-number="10"></a>
<a class="sourceLine" id="cb3-11" data-line-number="11">  putStrLn <span class="st">&quot;====&gt; Support of a singleton substitution&quot;</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12">  testWith args <span class="fu">$</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13">    test_support_singleton p</a>
<a class="sourceLine" id="cb3-14" data-line-number="14"></a>
<a class="sourceLine" id="cb3-15" data-line-number="15">  putStrLn <span class="st">&quot;====&gt; Apply the empty substitution&quot;</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16">  testWith args <span class="fu">$</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17">    test_sub_lookup_empty p</a>
<a class="sourceLine" id="cb3-18" data-line-number="18"></a>
<a class="sourceLine" id="cb3-19" data-line-number="19">  putStrLn <span class="st">&quot;====&gt; Apply a singleton substitution&quot;</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20">  testWith args <span class="fu">$</span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21">    test_sub_lookup_singleton p</a>
<a class="sourceLine" id="cb3-22" data-line-number="22"></a>
<a class="sourceLine" id="cb3-23" data-line-number="23">  putStrLn <span class="st">&quot;====&gt; Identity property for unionSub&quot;</span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24">  testWith args <span class="fu">$</span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25">    test_sub_union_identity p</a>
<a class="sourceLine" id="cb3-26" data-line-number="26"></a>
<a class="sourceLine" id="cb3-27" data-line-number="27">  putStrLn <span class="st">&quot;====&gt; Idempotent property for unionSub&quot;</span></a>
<a class="sourceLine" id="cb3-28" data-line-number="28">  testWith args <span class="fu">$</span></a>
<a class="sourceLine" id="cb3-29" data-line-number="29">    test_sub_union_idempotent p</a>
<a class="sourceLine" id="cb3-30" data-line-number="30"></a>
<a class="sourceLine" id="cb3-31" data-line-number="31">  putStrLn <span class="st">&quot;====&gt; Commutative property for unionSub&quot;</span></a>
<a class="sourceLine" id="cb3-32" data-line-number="32">  testWith args <span class="fu">$</span></a>
<a class="sourceLine" id="cb3-33" data-line-number="33">    test_sub_union_commutative p</a>
<a class="sourceLine" id="cb3-34" data-line-number="34"></a>
<a class="sourceLine" id="cb3-35" data-line-number="35">  putStrLn <span class="st">&quot;====&gt; Associative property for unionSub&quot;</span></a>
<a class="sourceLine" id="cb3-36" data-line-number="36">  testWith args <span class="fu">$</span></a>
<a class="sourceLine" id="cb3-37" data-line-number="37">    test_sub_union_associative p</a>
<a class="sourceLine" id="cb3-38" data-line-number="38"></a>
<a class="sourceLine" id="cb3-39" data-line-number="39">  putStrLn <span class="st">&quot;====&gt; unionSub on singletons&quot;</span></a>
<a class="sourceLine" id="cb3-40" data-line-number="40">  testWith args <span class="fu">$</span></a>
<a class="sourceLine" id="cb3-41" data-line-number="41">    test_sub_union_nothing p</a>
<a class="sourceLine" id="cb3-42" data-line-number="42"></a>
<a class="sourceLine" id="cb3-43" data-line-number="43">  putStrLn <span class="st">&quot;====&gt; Support of a union&quot;</span></a>
<a class="sourceLine" id="cb3-44" data-line-number="44">  testWith args <span class="fu">$</span></a>
<a class="sourceLine" id="cb3-45" data-line-number="45">    test_sub_union_support p</a>
<a class="sourceLine" id="cb3-46" data-line-number="46"></a>
<a class="sourceLine" id="cb3-47" data-line-number="47">  putStrLn <span class="st">&quot;====&gt; Identity property for extension&quot;</span></a>
<a class="sourceLine" id="cb3-48" data-line-number="48">  testWith args <span class="fu">$</span></a>
<a class="sourceLine" id="cb3-49" data-line-number="49">    test_sub_extend_empty p</a>
<a class="sourceLine" id="cb3-50" data-line-number="50"></a>
<a class="sourceLine" id="cb3-51" data-line-number="51">  putStrLn <span class="st">&quot;====&gt; Idempotent property for extension&quot;</span></a>
<a class="sourceLine" id="cb3-52" data-line-number="52">  testWith args <span class="fu">$</span></a>
<a class="sourceLine" id="cb3-53" data-line-number="53">    test_sub_extend_idempotent p</a>
<a class="sourceLine" id="cb3-54" data-line-number="54"></a>
<a class="sourceLine" id="cb3-55" data-line-number="55">  putStrLn <span class="st">&quot;====&gt; Left zero property for extension on singletons&quot;</span></a>
<a class="sourceLine" id="cb3-56" data-line-number="56">  testWith args <span class="fu">$</span></a>
<a class="sourceLine" id="cb3-57" data-line-number="57">    test_sub_extend_singleton p</a>
<a class="sourceLine" id="cb3-58" data-line-number="58"></a>
<a class="sourceLine" id="cb3-59" data-line-number="59">  putStrLn <span class="st">&quot;====&gt; Associative property for extension&quot;</span></a>
<a class="sourceLine" id="cb3-60" data-line-number="60">  testWith args <span class="fu">$</span></a>
<a class="sourceLine" id="cb3-61" data-line-number="61">    test_sub_extend_associative p</a>
<a class="sourceLine" id="cb3-62" data-line-number="62"></a>
<a class="sourceLine" id="cb3-63" data-line-number="63">  putStrLn <span class="st">&quot;====&gt; Support of an extension&quot;</span></a>
<a class="sourceLine" id="cb3-64" data-line-number="64">  testWith args <span class="fu">$</span></a>
<a class="sourceLine" id="cb3-65" data-line-number="65">    test_sub_extend_support p</a>
<a class="sourceLine" id="cb3-66" data-line-number="66"></a>
<a class="sourceLine" id="cb3-67" data-line-number="67">  putStrLn <span class="st">&quot;====&gt; Identity property for undefine&quot;</span></a>
<a class="sourceLine" id="cb3-68" data-line-number="68">  testWith args <span class="fu">$</span></a>
<a class="sourceLine" id="cb3-69" data-line-number="69">    test_undefine_identity p</a>
<a class="sourceLine" id="cb3-70" data-line-number="70"></a>
<a class="sourceLine" id="cb3-71" data-line-number="71">  putStrLn <span class="st">&quot;====&gt; Action property for undefine&quot;</span></a>
<a class="sourceLine" id="cb3-72" data-line-number="72">  testWith args <span class="fu">$</span></a>
<a class="sourceLine" id="cb3-73" data-line-number="73">    test_undefine_action p</a>
<a class="sourceLine" id="cb3-74" data-line-number="74"></a>
<a class="sourceLine" id="cb3-75" data-line-number="75">  putStrLn <span class="st">&quot;====&gt; undefine on singletons&quot;</span></a>
<a class="sourceLine" id="cb3-76" data-line-number="76">  testWith args <span class="fu">$</span></a>
<a class="sourceLine" id="cb3-77" data-line-number="77">    test_undefine_singleton p</a></code></pre></div>
<p>Now for tests of the whole module.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="ot">test_Sub ::</span> <span class="dt">Args</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">test_Sub args <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">  putStrLn <span class="st">&quot;\n--- Sub&quot;</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">  _Sub_properties args <span class="st">&quot;Int&quot;</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">Int</span>)</a></code></pre></div>
<h2 id="expressions">Expressions</h2>
<p>We bundle the properties of renaming expression variables for easy reuse.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb5-1" data-line-number="1">_HasExprVars_properties</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="ot">  ::</span> (<span class="dt">HasExprVars</span> t, <span class="dt">Eq</span> t, <span class="dt">Show</span> t, <span class="dt">Arbitrary</span> t)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">  <span class="ot">=&gt;</span> <span class="dt">Args</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">_HasExprVars_properties args name p <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">  putStrLn <span class="fu">$</span> <span class="st">&quot;&gt;&gt;&gt;&gt;&gt; HasExprVars properties: &quot;</span> <span class="fu">++</span> name</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"></a>
<a class="sourceLine" id="cb5-7" data-line-number="7">  putStrLn <span class="st">&quot;====&gt; Rename: free property&quot;</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8">  testWith args <span class="fu">$</span> test_exprvars_rename_free p</a>
<a class="sourceLine" id="cb5-9" data-line-number="9"></a>
<a class="sourceLine" id="cb5-10" data-line-number="10">  putStrLn <span class="st">&quot;====&gt; Rename: transposition property&quot;</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11">  testWith args <span class="fu">$</span> test_exprvars_rename_trans p</a>
<a class="sourceLine" id="cb5-12" data-line-number="12"></a>
<a class="sourceLine" id="cb5-13" data-line-number="13">  putStrLn <span class="st">&quot;====&gt; Rename: bound property&quot;</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14">  testWith args <span class="fu">$</span> test_exprvars_rename_bound p</a>
<a class="sourceLine" id="cb5-15" data-line-number="15"></a>
<a class="sourceLine" id="cb5-16" data-line-number="16">  putStrLn <span class="st">&quot;====&gt; Rename: bound equality&quot;</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17">  testWith args <span class="fu">$</span> test_exprvars_rename_eq p</a></code></pre></div>
<p>We bundle the properties of <code>Eq</code> for easy reuse.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb6-1" data-line-number="1">_Eq_properties</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="ot">  ::</span> (<span class="dt">Eq</span> t, <span class="dt">Show</span> t, <span class="dt">Arbitrary</span> t)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">  <span class="ot">=&gt;</span> <span class="dt">Args</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">_Eq_properties args name p <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5">  putStrLn <span class="fu">$</span> <span class="st">&quot;&gt;&gt;&gt;&gt;&gt; Eq properties: &quot;</span> <span class="fu">++</span> name</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"></a>
<a class="sourceLine" id="cb6-7" data-line-number="7">  putStrLn <span class="st">&quot;====&gt; Expr equality is reflexive&quot;</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8">  testWith args <span class="fu">$</span> test_eq_reflexive p</a>
<a class="sourceLine" id="cb6-9" data-line-number="9"></a>
<a class="sourceLine" id="cb6-10" data-line-number="10">  putStrLn <span class="st">&quot;====&gt; Expr equality is symmetric&quot;</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11">  testWith args <span class="fu">$</span> test_eq_symmetric p</a>
<a class="sourceLine" id="cb6-12" data-line-number="12"></a>
<a class="sourceLine" id="cb6-13" data-line-number="13">  putStrLn <span class="st">&quot;====&gt; Expr equality is transitive&quot;</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14">  testWith args <span class="fu">$</span> test_eq_transitive p</a></code></pre></div>
<p>And we bundle the properties of <code>Monoid</code> for reuse.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb7-1" data-line-number="1">_Monoid_properties</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="ot">  ::</span> (<span class="dt">Monoid</span> t, <span class="dt">Eq</span> t, <span class="dt">Show</span> t, <span class="dt">Arbitrary</span> t)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">  <span class="ot">=&gt;</span> <span class="dt">Args</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">_Monoid_properties args name p <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">  putStrLn <span class="fu">$</span> <span class="st">&quot;&gt;&gt;&gt;&gt;&gt; Monoid properties: &quot;</span> <span class="fu">++</span> name</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">  putStrLn <span class="st">&quot;====&gt; Monoid: Identity law&quot;</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7">  testWith args <span class="fu">$</span> test_monoid_identity p</a>
<a class="sourceLine" id="cb7-8" data-line-number="8"></a>
<a class="sourceLine" id="cb7-9" data-line-number="9">  putStrLn <span class="st">&quot;====&gt; Monoid: Associativity law&quot;</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10">  testWith args <span class="fu">$</span> test_monoid_associative p</a></code></pre></div>
<p>And for the monoid action properties of <code>SubExpr</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb8-1" data-line-number="1">_SubExpr_properties</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="ot">  ::</span> (<span class="dt">SubExpr</span> t, <span class="dt">Eq</span> t, <span class="dt">Show</span> t, <span class="dt">Arbitrary</span> t)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">  <span class="ot">=&gt;</span> <span class="dt">Args</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">_SubExpr_properties args name p <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5">  putStrLn <span class="fu">$</span> <span class="st">&quot;&gt;&gt;&gt;&gt;&gt; SubExpr properties: &quot;</span> <span class="fu">++</span> name</a>
<a class="sourceLine" id="cb8-6" data-line-number="6"></a>
<a class="sourceLine" id="cb8-7" data-line-number="7">  putStrLn <span class="st">&quot;====&gt; Identity law for Sub Expr action&quot;</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8">  testWith args <span class="fu">$</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9">    test_subexpr_identity p</a>
<a class="sourceLine" id="cb8-10" data-line-number="10"></a>
<a class="sourceLine" id="cb8-11" data-line-number="11">  putStrLn <span class="st">&quot;====&gt; Associativity law for Sub Expr action&quot;</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12">  testWith args <span class="fu">$</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13">    test_subexpr_action p</a></code></pre></div>
<p>Now for tests of the module.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="ot">test_Expr ::</span> <span class="dt">Args</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">test_Expr args <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3">  putStrLn <span class="st">&quot;\n--- Expr&quot;</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"></a>
<a class="sourceLine" id="cb9-5" data-line-number="5">  putStrLn <span class="st">&quot;====&gt; Freshness property for constants&quot;</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6">  testWith args <span class="fu">$</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7">    test_fresh_not_member (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> (<span class="dt">Con</span> <span class="dt">Expr</span>))</a>
<a class="sourceLine" id="cb9-8" data-line-number="8"></a>
<a class="sourceLine" id="cb9-9" data-line-number="9">  putStrLn <span class="st">&quot;====&gt; Freshness property for variables&quot;</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10">  testWith args <span class="fu">$</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11">    test_fresh_not_member (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> (<span class="dt">Var</span> <span class="dt">Expr</span>))</a>
<a class="sourceLine" id="cb9-12" data-line-number="12"></a>
<a class="sourceLine" id="cb9-13" data-line-number="13">  putStrLn <span class="st">&quot;====&gt; Expr: free variables test cases&quot;</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14">  test test_cases_freeExprVars</a>
<a class="sourceLine" id="cb9-15" data-line-number="15"></a>
<a class="sourceLine" id="cb9-16" data-line-number="16">  putStrLn <span class="st">&quot;====&gt; Expr: equality test cases&quot;</span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17">  test test_cases_expr_eq</a>
<a class="sourceLine" id="cb9-18" data-line-number="18"></a>
<a class="sourceLine" id="cb9-19" data-line-number="19">  _Eq_properties args <span class="st">&quot;Expr&quot;</span></a>
<a class="sourceLine" id="cb9-20" data-line-number="20">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">Expr</span>)</a>
<a class="sourceLine" id="cb9-21" data-line-number="21"></a>
<a class="sourceLine" id="cb9-22" data-line-number="22">  _HasExprVars_properties args <span class="st">&quot;Expr&quot;</span></a>
<a class="sourceLine" id="cb9-23" data-line-number="23">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">Expr</span>)</a>
<a class="sourceLine" id="cb9-24" data-line-number="24"></a>
<a class="sourceLine" id="cb9-25" data-line-number="25">  _Sub_properties args <span class="st">&quot;Expr&quot;</span></a>
<a class="sourceLine" id="cb9-26" data-line-number="26">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">Expr</span>)</a>
<a class="sourceLine" id="cb9-27" data-line-number="27"></a>
<a class="sourceLine" id="cb9-28" data-line-number="28">  _HasExprVars_properties args <span class="st">&quot;Sub Expr&quot;</span></a>
<a class="sourceLine" id="cb9-29" data-line-number="29">   (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> (<span class="dt">Sub</span> <span class="dt">Expr</span>))</a>
<a class="sourceLine" id="cb9-30" data-line-number="30"></a>
<a class="sourceLine" id="cb9-31" data-line-number="31">  putStrLn <span class="st">&quot;====&gt; Expr substitution test cases&quot;</span></a>
<a class="sourceLine" id="cb9-32" data-line-number="32">  test test_cases_sub_expr</a>
<a class="sourceLine" id="cb9-33" data-line-number="33"></a>
<a class="sourceLine" id="cb9-34" data-line-number="34">  _Monoid_properties args <span class="st">&quot;Sub Expr&quot;</span></a>
<a class="sourceLine" id="cb9-35" data-line-number="35">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> (<span class="dt">Sub</span> <span class="dt">Expr</span>))</a>
<a class="sourceLine" id="cb9-36" data-line-number="36"></a>
<a class="sourceLine" id="cb9-37" data-line-number="37">  _SubExpr_properties args <span class="st">&quot;Expr&quot;</span></a>
<a class="sourceLine" id="cb9-38" data-line-number="38">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">Expr</span>)</a>
<a class="sourceLine" id="cb9-39" data-line-number="39"></a>
<a class="sourceLine" id="cb9-40" data-line-number="40">  _SubExpr_properties args <span class="st">&quot;Sub Expr&quot;</span></a>
<a class="sourceLine" id="cb9-41" data-line-number="41">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> (<span class="dt">Sub</span> <span class="dt">Expr</span>))</a>
<a class="sourceLine" id="cb9-42" data-line-number="42"></a>
<a class="sourceLine" id="cb9-43" data-line-number="43">  putStrLn <span class="st">&quot;====&gt; Matching: Expr test cases&quot;</span></a>
<a class="sourceLine" id="cb9-44" data-line-number="44">  test test_cases_expr_match</a>
<a class="sourceLine" id="cb9-45" data-line-number="45"></a>
<a class="sourceLine" id="cb9-46" data-line-number="46">  putStrLn <span class="st">&quot;====&gt; Matching: Expr substitution property&quot;</span></a>
<a class="sourceLine" id="cb9-47" data-line-number="47">  testWith args test_expr_match_sub</a>
<a class="sourceLine" id="cb9-48" data-line-number="48"></a>
<a class="sourceLine" id="cb9-49" data-line-number="49">  putStrLn <span class="st">&quot;====&gt; Matching: Expr transitive property&quot;</span></a>
<a class="sourceLine" id="cb9-50" data-line-number="50">  testWith args test_expr_match_transitive</a>
<a class="sourceLine" id="cb9-51" data-line-number="51"></a>
<a class="sourceLine" id="cb9-52" data-line-number="52">  putStrLn <span class="st">&quot;====&gt; Matching: Expr match self&quot;</span></a>
<a class="sourceLine" id="cb9-53" data-line-number="53">  testWith args test_expr_match_self</a>
<a class="sourceLine" id="cb9-54" data-line-number="54"></a>
<a class="sourceLine" id="cb9-55" data-line-number="55">  putStrLn <span class="st">&quot;====&gt; Matching: Expr match rename&quot;</span></a>
<a class="sourceLine" id="cb9-56" data-line-number="56">  testWith args test_expr_match_rename</a>
<a class="sourceLine" id="cb9-57" data-line-number="57"> </a>
<a class="sourceLine" id="cb9-58" data-line-number="58">  putStrLn <span class="st">&quot;====&gt; Matching: Expr with explicit substitution&quot;</span></a>
<a class="sourceLine" id="cb9-59" data-line-number="59">  testWith args test_expr_sub_match</a></code></pre></div>
<h2 id="types">Types</h2>
<p>We bundle the properties of <code>SubMono</code> for reuse.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb10-1" data-line-number="1">_SubMono_properties</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="ot">  ::</span> (<span class="dt">SubMono</span> t, <span class="dt">Eq</span> t, <span class="dt">Show</span> t, <span class="dt">Arbitrary</span> t)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">  <span class="ot">=&gt;</span> <span class="dt">Args</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">_SubMono_properties args name p <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5">  putStrLn <span class="fu">$</span> <span class="st">&quot;&gt;&gt;&gt;&gt;&gt; SubMono properties: &quot;</span> <span class="fu">++</span> name</a>
<a class="sourceLine" id="cb10-6" data-line-number="6"></a>
<a class="sourceLine" id="cb10-7" data-line-number="7">  putStrLn <span class="st">&quot;====&gt; Identity law for SubMono action&quot;</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8">  testWith args <span class="fu">$</span> test_submono_identity p</a>
<a class="sourceLine" id="cb10-9" data-line-number="9"></a>
<a class="sourceLine" id="cb10-10" data-line-number="10">  putStrLn <span class="st">&quot;====&gt; Associativity law for SubMono action&quot;</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11">  testWith args <span class="fu">$</span> test_submono_action p</a></code></pre></div>
<p>And properties of <code>UnifyTypes</code>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb11-1" data-line-number="1">_UnifyTypes_properties</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="ot">  ::</span> (<span class="dt">UnifyTypes</span> t, <span class="dt">Eq</span> t, <span class="dt">Show</span> t, <span class="dt">Arbitrary</span> t)</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">  <span class="ot">=&gt;</span> <span class="dt">Args</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">_UnifyTypes_properties args name p <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5">  putStrLn <span class="fu">$</span> <span class="st">&quot;&gt;&gt;&gt;&gt;&gt; UnifyTypes properties: &quot;</span> <span class="fu">++</span> name</a>
<a class="sourceLine" id="cb11-6" data-line-number="6"></a>
<a class="sourceLine" id="cb11-7" data-line-number="7">  putStrLn <span class="st">&quot;====&gt; Substitution property for unify&quot;</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8">  testWith args <span class="fu">$</span> test_unify_eq p</a>
<a class="sourceLine" id="cb11-9" data-line-number="9"></a>
<a class="sourceLine" id="cb11-10" data-line-number="10">  putStrLn <span class="st">&quot;====&gt; Self property for unify&quot;</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11">  testWith args <span class="fu">$</span> test_unify_self_empty p</a>
<a class="sourceLine" id="cb11-12" data-line-number="12"></a>
<a class="sourceLine" id="cb11-13" data-line-number="13">  putStrLn <span class="st">&quot;====&gt; Commutative property for unify&quot;</span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14">  testWith args <span class="fu">$</span> test_unify_symmetric p</a>
<a class="sourceLine" id="cb11-15" data-line-number="15"></a>
<a class="sourceLine" id="cb11-16" data-line-number="16">  putStrLn <span class="st">&quot;====&gt; Closure property for unify&quot;</span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17">  testWith args <span class="fu">$</span> test_unify_down_closed p</a></code></pre></div>
<p>Now for the module tests.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="ot">test_Type ::</span> <span class="dt">Args</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">test_Type args <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3">  putStrLn <span class="st">&quot;\n--- Type&quot;</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"></a>
<a class="sourceLine" id="cb12-5" data-line-number="5">  putStrLn <span class="st">&quot;====&gt; Freshness property for constants&quot;</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6">  testWith args <span class="fu">$</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7">    test_fresh_not_member (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> (<span class="dt">Con</span> <span class="dt">MonoType</span>))</a>
<a class="sourceLine" id="cb12-8" data-line-number="8"></a>
<a class="sourceLine" id="cb12-9" data-line-number="9">  putStrLn <span class="st">&quot;====&gt; Freshness property for variables&quot;</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10">  testWith args <span class="fu">$</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11">    test_fresh_not_member (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> (<span class="dt">Var</span> <span class="dt">MonoType</span>))</a>
<a class="sourceLine" id="cb12-12" data-line-number="12"></a>
<a class="sourceLine" id="cb12-13" data-line-number="13">  _Sub_properties args <span class="st">&quot;MonoType&quot;</span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">MonoType</span>)</a>
<a class="sourceLine" id="cb12-15" data-line-number="15"></a>
<a class="sourceLine" id="cb12-16" data-line-number="16">  _Monoid_properties args <span class="st">&quot;Sub MonoType&quot;</span></a>
<a class="sourceLine" id="cb12-17" data-line-number="17">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> (<span class="dt">Sub</span> <span class="dt">MonoType</span>))</a>
<a class="sourceLine" id="cb12-18" data-line-number="18"></a>
<a class="sourceLine" id="cb12-19" data-line-number="19">  _SubMono_properties args <span class="st">&quot;MonoType&quot;</span></a>
<a class="sourceLine" id="cb12-20" data-line-number="20">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">MonoType</span>)</a>
<a class="sourceLine" id="cb12-21" data-line-number="21"></a>
<a class="sourceLine" id="cb12-22" data-line-number="22">  _SubMono_properties args <span class="st">&quot;Sub MonoType&quot;</span></a>
<a class="sourceLine" id="cb12-23" data-line-number="23">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> (<span class="dt">Sub</span> <span class="dt">MonoType</span>))</a>
<a class="sourceLine" id="cb12-24" data-line-number="24"></a>
<a class="sourceLine" id="cb12-25" data-line-number="25">  _UnifyTypes_properties args <span class="st">&quot;MonoType&quot;</span></a>
<a class="sourceLine" id="cb12-26" data-line-number="26">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">MonoType</span>)</a>
<a class="sourceLine" id="cb12-27" data-line-number="27"></a>
<a class="sourceLine" id="cb12-28" data-line-number="28">  putStrLn <span class="st">&quot;====&gt; Test cases: polytype equality&quot;</span></a>
<a class="sourceLine" id="cb12-29" data-line-number="29">  test test_cases_polytype_eq</a>
<a class="sourceLine" id="cb12-30" data-line-number="30"></a>
<a class="sourceLine" id="cb12-31" data-line-number="31">  _Eq_properties args <span class="st">&quot;PolyType&quot;</span></a>
<a class="sourceLine" id="cb12-32" data-line-number="32">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">PolyType</span>)</a>
<a class="sourceLine" id="cb12-33" data-line-number="33"></a>
<a class="sourceLine" id="cb12-34" data-line-number="34">  putStrLn <span class="st">&quot;====&gt; PolyType equality rename property&quot;</span></a>
<a class="sourceLine" id="cb12-35" data-line-number="35">  testWith args test_polytype_eq_renames</a>
<a class="sourceLine" id="cb12-36" data-line-number="36"></a>
<a class="sourceLine" id="cb12-37" data-line-number="37">  _SubMono_properties args <span class="st">&quot;PolyType&quot;</span></a>
<a class="sourceLine" id="cb12-38" data-line-number="38">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">PolyType</span>)</a>
<a class="sourceLine" id="cb12-39" data-line-number="39"></a>
<a class="sourceLine" id="cb12-40" data-line-number="40">  putStrLn <span class="st">&quot;====&gt; PolyType: unification test cases&quot;</span></a>
<a class="sourceLine" id="cb12-41" data-line-number="41">  test test_cases_unify_polytype</a>
<a class="sourceLine" id="cb12-42" data-line-number="42"></a>
<a class="sourceLine" id="cb12-43" data-line-number="43">  _UnifyTypes_properties args <span class="st">&quot;PolyType&quot;</span></a>
<a class="sourceLine" id="cb12-44" data-line-number="44">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">PolyType</span>)</a></code></pre></div>
<h2 id="infer">Infer</h2>
<p>We bundle the property tests for <code>TypeCheck</code> for reuse.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb13-1" data-line-number="1">_TypeCheck_properties</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="ot">  ::</span> (<span class="dt">TypeCheck</span> t, <span class="dt">Eq</span> t, <span class="dt">Show</span> t, <span class="dt">Arbitrary</span> t)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">  <span class="ot">=&gt;</span> <span class="dt">Args</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">_TypeCheck_properties args name p <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5">  putStrLn <span class="fu">$</span> <span class="st">&quot;&gt;&gt;&gt;&gt;&gt; TypeCheck properties: &quot;</span> <span class="fu">++</span> name</a>
<a class="sourceLine" id="cb13-6" data-line-number="6"></a>
<a class="sourceLine" id="cb13-7" data-line-number="7">  putStrLn <span class="st">&quot;====&gt; TypeCheck: free variables have a type&quot;</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8">  testWith args <span class="fu">$</span> test_typecheck_free_vars p</a>
<a class="sourceLine" id="cb13-9" data-line-number="9"></a>
<a class="sourceLine" id="cb13-10" data-line-number="10">  putStrLn <span class="st">&quot;====&gt; TypeCheck: renaming bound vars&quot;</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11">  testWith args <span class="fu">$</span> test_typecheck_bound_vars p</a>
<a class="sourceLine" id="cb13-12" data-line-number="12"></a>
<a class="sourceLine" id="cb13-13" data-line-number="13">  putStrLn <span class="st">&quot;====&gt; TypeCheck: renaming free vars&quot;</span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14">  testWith args <span class="fu">$</span> test_typecheck_rename_free p</a></code></pre></div>
<p>Now the module tests.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="ot">test_Infer ::</span> <span class="dt">Args</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">test_Infer args <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3">  putStrLn <span class="st">&quot;\n--- Infer&quot;</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"></a>
<a class="sourceLine" id="cb14-5" data-line-number="5">  _SubMono_properties args <span class="st">&quot;TypeEnv&quot;</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">TypeEnv</span>)</a>
<a class="sourceLine" id="cb14-7" data-line-number="7"></a>
<a class="sourceLine" id="cb14-8" data-line-number="8">  _UnifyTypes_properties args <span class="st">&quot;TypeEnv&quot;</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">TypeEnv</span>)</a>
<a class="sourceLine" id="cb14-10" data-line-number="10"></a>
<a class="sourceLine" id="cb14-11" data-line-number="11">  putStrLn <span class="st">&quot;====&gt; Type inference test cases&quot;</span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12">  test test_cases_infer</a>
<a class="sourceLine" id="cb14-13" data-line-number="13"></a>
<a class="sourceLine" id="cb14-14" data-line-number="14">  putStrLn <span class="st">&quot;====&gt; G |-S e : t =&gt; SG |-S e : St&quot;</span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15">  testWith args test_infer_sub</a>
<a class="sourceLine" id="cb14-16" data-line-number="16"></a>
<a class="sourceLine" id="cb14-17" data-line-number="17">  putStrLn <span class="st">&quot;====&gt; TypeCheck test cases: Expr&quot;</span></a>
<a class="sourceLine" id="cb14-18" data-line-number="18">  test test_cases_typecheck_expr</a>
<a class="sourceLine" id="cb14-19" data-line-number="19"></a>
<a class="sourceLine" id="cb14-20" data-line-number="20">  _TypeCheck_properties args <span class="st">&quot;Expr&quot;</span></a>
<a class="sourceLine" id="cb14-21" data-line-number="21">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">Expr</span>)</a></code></pre></div>
<h2 id="judgements">Judgements</h2>
<p>We package the monoid action property tests of judgement substitution for easy reuse.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb15-1" data-line-number="1">_SubJud_properties</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="ot">  ::</span> (<span class="dt">JudSub</span> t, <span class="dt">Eq</span> t, <span class="dt">Show</span> t, <span class="dt">Arbitrary</span> t)</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">  <span class="ot">=&gt;</span> <span class="dt">Args</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">_SubJud_properties args name p <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5">  putStrLn <span class="fu">$</span> <span class="st">&quot;&gt;&gt;&gt;&gt;&gt; SubJud properties: &quot;</span> <span class="fu">++</span> name</a>
<a class="sourceLine" id="cb15-6" data-line-number="6"></a>
<a class="sourceLine" id="cb15-7" data-line-number="7">  putStrLn <span class="st">&quot;====&gt; Identity law for Sub Jud action&quot;</span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8">  testWith args <span class="fu">$</span> test_subjud_identity p</a>
<a class="sourceLine" id="cb15-9" data-line-number="9"></a>
<a class="sourceLine" id="cb15-10" data-line-number="10">  putStrLn <span class="st">&quot;====&gt; Associativity law for Sub Jud action&quot;</span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11">  testWith args <span class="fu">$</span> test_subjud_action p</a></code></pre></div>
<p>Tests for the module:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="ot">test_Jud ::</span> <span class="dt">Args</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">test_Jud args <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3">  putStrLn <span class="st">&quot;\n--- Jud&quot;</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"></a>
<a class="sourceLine" id="cb16-5" data-line-number="5">  putStrLn <span class="st">&quot;====&gt; Freshness property for variables&quot;</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6">  testWith args <span class="fu">$</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7">    test_fresh_not_member (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> (<span class="dt">Var</span> <span class="dt">Jud</span>))</a>
<a class="sourceLine" id="cb16-8" data-line-number="8"></a>
<a class="sourceLine" id="cb16-9" data-line-number="9">  _HasExprVars_properties args <span class="st">&quot;Jud&quot;</span></a>
<a class="sourceLine" id="cb16-10" data-line-number="10">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">Jud</span>)</a>
<a class="sourceLine" id="cb16-11" data-line-number="11"></a>
<a class="sourceLine" id="cb16-12" data-line-number="12">  _Eq_properties args <span class="st">&quot;Jud&quot;</span></a>
<a class="sourceLine" id="cb16-13" data-line-number="13">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">Jud</span>)</a>
<a class="sourceLine" id="cb16-14" data-line-number="14"></a>
<a class="sourceLine" id="cb16-15" data-line-number="15">  _SubExpr_properties args <span class="st">&quot;Jud&quot;</span></a>
<a class="sourceLine" id="cb16-16" data-line-number="16">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">Jud</span>)</a>
<a class="sourceLine" id="cb16-17" data-line-number="17"></a>
<a class="sourceLine" id="cb16-18" data-line-number="18">  _SubExpr_properties args <span class="st">&quot;Sub Jud&quot;</span></a>
<a class="sourceLine" id="cb16-19" data-line-number="19">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> (<span class="dt">Sub</span> <span class="dt">Jud</span>))</a>
<a class="sourceLine" id="cb16-20" data-line-number="20"></a>
<a class="sourceLine" id="cb16-21" data-line-number="21">  _HasExprVars_properties args <span class="st">&quot;Sub Jud&quot;</span></a>
<a class="sourceLine" id="cb16-22" data-line-number="22">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> (<span class="dt">Sub</span> <span class="dt">Jud</span>))</a>
<a class="sourceLine" id="cb16-23" data-line-number="23"></a>
<a class="sourceLine" id="cb16-24" data-line-number="24">  _Monoid_properties args <span class="st">&quot;Sub Jud&quot;</span></a>
<a class="sourceLine" id="cb16-25" data-line-number="25">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> (<span class="dt">Sub</span> <span class="dt">Jud</span>))</a>
<a class="sourceLine" id="cb16-26" data-line-number="26"></a>
<a class="sourceLine" id="cb16-27" data-line-number="27">  _SubJud_properties args <span class="st">&quot;Jud&quot;</span></a>
<a class="sourceLine" id="cb16-28" data-line-number="28">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">Jud</span>)</a>
<a class="sourceLine" id="cb16-29" data-line-number="29"></a>
<a class="sourceLine" id="cb16-30" data-line-number="30">  _SubJud_properties args <span class="st">&quot;Sub Jud&quot;</span></a>
<a class="sourceLine" id="cb16-31" data-line-number="31">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> (<span class="dt">Sub</span> <span class="dt">Jud</span>))</a>
<a class="sourceLine" id="cb16-32" data-line-number="32"></a>
<a class="sourceLine" id="cb16-33" data-line-number="33">  putStrLn <span class="st">&quot;====&gt; Matching: Jud test cases&quot;</span></a>
<a class="sourceLine" id="cb16-34" data-line-number="34">  test test_cases_jud_match</a>
<a class="sourceLine" id="cb16-35" data-line-number="35"></a>
<a class="sourceLine" id="cb16-36" data-line-number="36">  putStrLn <span class="st">&quot;====&gt; Matching: Jud substitution property&quot;</span></a>
<a class="sourceLine" id="cb16-37" data-line-number="37">  testWith args test_jud_match</a>
<a class="sourceLine" id="cb16-38" data-line-number="38"></a>
<a class="sourceLine" id="cb16-39" data-line-number="39">  putStrLn <span class="st">&quot;====&gt; Matching: Jud self match&quot;</span></a>
<a class="sourceLine" id="cb16-40" data-line-number="40">  testWith args test_jud_match_self</a>
<a class="sourceLine" id="cb16-41" data-line-number="41"></a>
<a class="sourceLine" id="cb16-42" data-line-number="42">  putStrLn <span class="st">&quot;====&gt; Matching: Jud rename bound vars&quot;</span></a>
<a class="sourceLine" id="cb16-43" data-line-number="43">  testWith args test_jud_match_rename_bound</a>
<a class="sourceLine" id="cb16-44" data-line-number="44"></a>
<a class="sourceLine" id="cb16-45" data-line-number="45">  putStrLn <span class="st">&quot;====&gt; Matching: Jud explicit substitution&quot;</span></a>
<a class="sourceLine" id="cb16-46" data-line-number="46">  testWith args test_jud_match_sub</a>
<a class="sourceLine" id="cb16-47" data-line-number="47"></a>
<a class="sourceLine" id="cb16-48" data-line-number="48">  _TypeCheck_properties args <span class="st">&quot;Jud&quot;</span></a>
<a class="sourceLine" id="cb16-49" data-line-number="49">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">Jud</span>)</a></code></pre></div>
<h2 id="proofs">Proofs</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="ot">test_Proof ::</span> <span class="dt">Args</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">test_Proof args <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3">  putStrLn <span class="st">&quot;\n--- Proof&quot;</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"></a>
<a class="sourceLine" id="cb17-5" data-line-number="5">  putStrLn <span class="st">&quot;====&gt; Matching: Rule substitution property&quot;</span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6">  testWith args test_match_rule</a>
<a class="sourceLine" id="cb17-7" data-line-number="7"></a>
<a class="sourceLine" id="cb17-8" data-line-number="8">  putStrLn <span class="st">&quot;====&gt; Matching: Rule self property&quot;</span></a>
<a class="sourceLine" id="cb17-9" data-line-number="9">  testWith args test_match_rule_self</a>
<a class="sourceLine" id="cb17-10" data-line-number="10"></a>
<a class="sourceLine" id="cb17-11" data-line-number="11">  putStrLn <span class="st">&quot;====&gt; Matching: Rule explicit substitution&quot;</span></a>
<a class="sourceLine" id="cb17-12" data-line-number="12">  testWith args test_match_rule_sub</a>
<a class="sourceLine" id="cb17-13" data-line-number="13"></a>
<a class="sourceLine" id="cb17-14" data-line-number="14">  _HasExprVars_properties args <span class="st">&quot;Rule&quot;</span></a>
<a class="sourceLine" id="cb17-15" data-line-number="15">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">Rule</span>)</a>
<a class="sourceLine" id="cb17-16" data-line-number="16"></a>
<a class="sourceLine" id="cb17-17" data-line-number="17">  _TypeCheck_properties args <span class="st">&quot;Rule&quot;</span></a>
<a class="sourceLine" id="cb17-18" data-line-number="18">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">Rule</span>)</a>
<a class="sourceLine" id="cb17-19" data-line-number="19"></a>
<a class="sourceLine" id="cb17-20" data-line-number="20">  putStrLn <span class="st">&quot;====&gt; Rule typecheck test cases&quot;</span></a>
<a class="sourceLine" id="cb17-21" data-line-number="21">  test test_cases_rule_typecheck</a>
<a class="sourceLine" id="cb17-22" data-line-number="22"></a>
<a class="sourceLine" id="cb17-23" data-line-number="23">  _HasExprVars_properties args <span class="st">&quot;HypEnv&quot;</span></a>
<a class="sourceLine" id="cb17-24" data-line-number="24">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">HypEnv</span>)</a>
<a class="sourceLine" id="cb17-25" data-line-number="25"></a>
<a class="sourceLine" id="cb17-26" data-line-number="26">  _HasExprVars_properties args <span class="st">&quot;Assumptions&quot;</span></a>
<a class="sourceLine" id="cb17-27" data-line-number="27">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">Assumptions</span>)</a>
<a class="sourceLine" id="cb17-28" data-line-number="28"></a>
<a class="sourceLine" id="cb17-29" data-line-number="29">  _Monoid_properties args <span class="st">&quot;Assumptions&quot;</span></a>
<a class="sourceLine" id="cb17-30" data-line-number="30">    (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">Assumptions</span>)</a></code></pre></div>
<h2 id="module">Module</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="ot">test_Module ::</span> <span class="dt">Args</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb18-2" data-line-number="2">test_Module args <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3">  putStrLn <span class="st">&quot;\n--- Module&quot;</span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4"></a>
<a class="sourceLine" id="cb18-5" data-line-number="5">  putStrLn <span class="st">&quot;====&gt; Proof Checking: Toys&quot;</span></a>
<a class="sourceLine" id="cb18-6" data-line-number="6">  test test_toy_theory</a></code></pre></div>
<h2 id="fancy">Fancy</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="ot">test_Fancy ::</span> <span class="dt">Args</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb19-2" data-line-number="2">test_Fancy args <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3">  putStrLn <span class="st">&quot;\n--- Fancy&quot;</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"></a>
<a class="sourceLine" id="cb19-5" data-line-number="5">  putStrLn <span class="st">&quot;====&gt; Deserialization&quot;</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6">  testWith args test_deserialize</a></code></pre></div>
<h2 id="parsing">Parsing</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="ot">test_Parser ::</span> <span class="dt">Args</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">test_Parser args <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3">  putStrLn <span class="st">&quot;\n--- Parser&quot;</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"></a>
<a class="sourceLine" id="cb20-5" data-line-number="5">  putStrLn <span class="st">&quot;====&gt; Basic Syntax: Var Expr&quot;</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6">  testWith args <span class="fu">$</span> test_prettybasic (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> (<span class="dt">Var</span> <span class="dt">Expr</span>))</a>
<a class="sourceLine" id="cb20-7" data-line-number="7"></a>
<a class="sourceLine" id="cb20-8" data-line-number="8">  putStrLn <span class="st">&quot;====&gt; Test cases: parse Var Expr&quot;</span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9">  test test_cases_parse_varexpr</a>
<a class="sourceLine" id="cb20-10" data-line-number="10"></a>
<a class="sourceLine" id="cb20-11" data-line-number="11">  putStrLn <span class="st">&quot;====&gt; Basic Syntax: Con Expr&quot;</span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12">  testWith args <span class="fu">$</span> test_prettybasic (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> (<span class="dt">Con</span> <span class="dt">Expr</span>))</a>
<a class="sourceLine" id="cb20-13" data-line-number="13"></a>
<a class="sourceLine" id="cb20-14" data-line-number="14">  putStrLn <span class="st">&quot;====&gt; Test cases: parse Con Expr&quot;</span></a>
<a class="sourceLine" id="cb20-15" data-line-number="15">  test test_cases_parse_conexpr</a>
<a class="sourceLine" id="cb20-16" data-line-number="16"></a>
<a class="sourceLine" id="cb20-17" data-line-number="17">  putStrLn <span class="st">&quot;====&gt; Basic Syntax: Expr&quot;</span></a>
<a class="sourceLine" id="cb20-18" data-line-number="18">  testWith args <span class="fu">$</span> test_prettybasic (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">Expr</span>)</a>
<a class="sourceLine" id="cb20-19" data-line-number="19"></a>
<a class="sourceLine" id="cb20-20" data-line-number="20">  putStrLn <span class="st">&quot;====&gt; Test cases: parse Expr&quot;</span></a>
<a class="sourceLine" id="cb20-21" data-line-number="21">  test test_cases_parse_expr</a>
<a class="sourceLine" id="cb20-22" data-line-number="22"></a>
<a class="sourceLine" id="cb20-23" data-line-number="23">  putStrLn <span class="st">&quot;====&gt; Basic Syntax: Var MonoType&quot;</span></a>
<a class="sourceLine" id="cb20-24" data-line-number="24">  testWith args <span class="fu">$</span> test_prettybasic (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> (<span class="dt">Var</span> <span class="dt">MonoType</span>))</a>
<a class="sourceLine" id="cb20-25" data-line-number="25"></a>
<a class="sourceLine" id="cb20-26" data-line-number="26">  putStrLn <span class="st">&quot;====&gt; Test cases: parse Var MonoType&quot;</span></a>
<a class="sourceLine" id="cb20-27" data-line-number="27">  test test_cases_parse_varmonotype</a>
<a class="sourceLine" id="cb20-28" data-line-number="28"></a>
<a class="sourceLine" id="cb20-29" data-line-number="29">  putStrLn <span class="st">&quot;====&gt; Basic Syntax: Con MonoType&quot;</span></a>
<a class="sourceLine" id="cb20-30" data-line-number="30">  testWith args <span class="fu">$</span> test_prettybasic (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> (<span class="dt">Con</span> <span class="dt">MonoType</span>))</a>
<a class="sourceLine" id="cb20-31" data-line-number="31"></a>
<a class="sourceLine" id="cb20-32" data-line-number="32">  putStrLn <span class="st">&quot;====&gt; Test cases: parse Con MonoType&quot;</span></a>
<a class="sourceLine" id="cb20-33" data-line-number="33">  test test_cases_parse_conmonotype</a>
<a class="sourceLine" id="cb20-34" data-line-number="34"></a>
<a class="sourceLine" id="cb20-35" data-line-number="35">  putStrLn <span class="st">&quot;====&gt; Basic Syntax: MonoType&quot;</span></a>
<a class="sourceLine" id="cb20-36" data-line-number="36">  testWith args <span class="fu">$</span> test_prettybasic (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">MonoType</span>)</a>
<a class="sourceLine" id="cb20-37" data-line-number="37"></a>
<a class="sourceLine" id="cb20-38" data-line-number="38">  putStrLn <span class="st">&quot;====&gt; Test cases: parse MonoType&quot;</span></a>
<a class="sourceLine" id="cb20-39" data-line-number="39">  test test_cases_parse_monotype</a>
<a class="sourceLine" id="cb20-40" data-line-number="40"></a>
<a class="sourceLine" id="cb20-41" data-line-number="41">  putStrLn <span class="st">&quot;====&gt; Basic Syntax: PolyType&quot;</span></a>
<a class="sourceLine" id="cb20-42" data-line-number="42">  testWith args <span class="fu">$</span> test_prettybasic (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">PolyType</span>)</a>
<a class="sourceLine" id="cb20-43" data-line-number="43"></a>
<a class="sourceLine" id="cb20-44" data-line-number="44">  putStrLn <span class="st">&quot;====&gt; Test cases: parse PolyType&quot;</span></a>
<a class="sourceLine" id="cb20-45" data-line-number="45">  test test_cases_parse_polytype</a>
<a class="sourceLine" id="cb20-46" data-line-number="46"></a>
<a class="sourceLine" id="cb20-47" data-line-number="47">  putStrLn <span class="st">&quot;====&gt; Basic Syntax: Sub Expr&quot;</span></a>
<a class="sourceLine" id="cb20-48" data-line-number="48">  testWith args <span class="fu">$</span> test_prettybasic (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> (<span class="dt">Sub</span> <span class="dt">Expr</span>))</a>
<a class="sourceLine" id="cb20-49" data-line-number="49"></a>
<a class="sourceLine" id="cb20-50" data-line-number="50">  putStrLn <span class="st">&quot;====&gt; Test cases: parse Sub Expr&quot;</span></a>
<a class="sourceLine" id="cb20-51" data-line-number="51">  test test_cases_parse_subexpr</a>
<a class="sourceLine" id="cb20-52" data-line-number="52"></a>
<a class="sourceLine" id="cb20-53" data-line-number="53">  putStrLn <span class="st">&quot;====&gt; Basic Syntax: Var Jud&quot;</span></a>
<a class="sourceLine" id="cb20-54" data-line-number="54">  testWith args <span class="fu">$</span> test_prettybasic (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> (<span class="dt">Var</span> <span class="dt">Jud</span>))</a>
<a class="sourceLine" id="cb20-55" data-line-number="55"></a>
<a class="sourceLine" id="cb20-56" data-line-number="56">  putStrLn <span class="st">&quot;====&gt; Test cases: parse Var Jud&quot;</span></a>
<a class="sourceLine" id="cb20-57" data-line-number="57">  test test_cases_parse_varjud</a>
<a class="sourceLine" id="cb20-58" data-line-number="58"></a>
<a class="sourceLine" id="cb20-59" data-line-number="59">  putStrLn <span class="st">&quot;====&gt; Basic Syntax: Jud&quot;</span></a>
<a class="sourceLine" id="cb20-60" data-line-number="60">  testWith args <span class="fu">$</span> test_prettybasic (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">Jud</span>)</a>
<a class="sourceLine" id="cb20-61" data-line-number="61"></a>
<a class="sourceLine" id="cb20-62" data-line-number="62">  putStrLn <span class="st">&quot;====&gt; Test cases: parse Var Jud&quot;</span></a>
<a class="sourceLine" id="cb20-63" data-line-number="63">  test test_cases_parse_varjud</a>
<a class="sourceLine" id="cb20-64" data-line-number="64"></a>
<a class="sourceLine" id="cb20-65" data-line-number="65">  putStrLn <span class="st">&quot;====&gt; Basic Syntax: HypName&quot;</span></a>
<a class="sourceLine" id="cb20-66" data-line-number="66">  testWith args <span class="fu">$</span> test_prettybasic (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">HypName</span>)</a>
<a class="sourceLine" id="cb20-67" data-line-number="67"></a>
<a class="sourceLine" id="cb20-68" data-line-number="68">  putStrLn <span class="st">&quot;====&gt; Basic Syntax: RuleName&quot;</span></a>
<a class="sourceLine" id="cb20-69" data-line-number="69">  testWith args <span class="fu">$</span> test_prettybasic (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">RuleName</span>)</a>
<a class="sourceLine" id="cb20-70" data-line-number="70"></a>
<a class="sourceLine" id="cb20-71" data-line-number="71">  putStrLn <span class="st">&quot;====&gt; Basic Syntax: Rule&quot;</span></a>
<a class="sourceLine" id="cb20-72" data-line-number="72">  testWith args <span class="fu">$</span> test_prettybasic (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">Rule</span>)</a>
<a class="sourceLine" id="cb20-73" data-line-number="73"></a>
<a class="sourceLine" id="cb20-74" data-line-number="74">  putStrLn <span class="st">&quot;====&gt; Fancy Syntax: Rule&quot;</span></a>
<a class="sourceLine" id="cb20-75" data-line-number="75">  testWith args <span class="fu">$</span> test_prettyfancy (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">Rule</span>)</a>
<a class="sourceLine" id="cb20-76" data-line-number="76"></a>
<a class="sourceLine" id="cb20-77" data-line-number="77">  putStrLn <span class="st">&quot;====&gt; Test cases: parse Rule (Basic)&quot;</span></a>
<a class="sourceLine" id="cb20-78" data-line-number="78">  test test_cases_parse_rule_basic</a>
<a class="sourceLine" id="cb20-79" data-line-number="79"></a>
<a class="sourceLine" id="cb20-80" data-line-number="80">  putStrLn <span class="st">&quot;====&gt; Test cases: parse Rule (Fancy)&quot;</span></a>
<a class="sourceLine" id="cb20-81" data-line-number="81">  test test_cases_parse_rule_fancy</a>
<a class="sourceLine" id="cb20-82" data-line-number="82"></a>
<a class="sourceLine" id="cb20-83" data-line-number="83">  putStrLn <span class="st">&quot;====&gt; Basic Syntax: Proof&quot;</span></a>
<a class="sourceLine" id="cb20-84" data-line-number="84">  testWith args <span class="fu">$</span> test_prettybasic (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">Proof</span>)</a>
<a class="sourceLine" id="cb20-85" data-line-number="85"></a>
<a class="sourceLine" id="cb20-86" data-line-number="86">  putStrLn <span class="st">&quot;====&gt; Basic Syntax: FancyProofLine&quot;</span></a>
<a class="sourceLine" id="cb20-87" data-line-number="87">  testWith args <span class="fu">$</span> test_prettybasic (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">FancyProofLine</span>)</a>
<a class="sourceLine" id="cb20-88" data-line-number="88"></a>
<a class="sourceLine" id="cb20-89" data-line-number="89">  putStrLn <span class="st">&quot;====&gt; Basic Syntax: FancyProof&quot;</span></a>
<a class="sourceLine" id="cb20-90" data-line-number="90">  testWith args <span class="fu">$</span> test_prettybasic (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">FancyProof</span>)</a>
<a class="sourceLine" id="cb20-91" data-line-number="91"></a>
<a class="sourceLine" id="cb20-92" data-line-number="92">  putStrLn <span class="st">&quot;====&gt; Fancy Syntax: Proof&quot;</span></a>
<a class="sourceLine" id="cb20-93" data-line-number="93">  testWith args <span class="fu">$</span> test_prettyfancy (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">Proof</span>)</a>
<a class="sourceLine" id="cb20-94" data-line-number="94"></a>
<a class="sourceLine" id="cb20-95" data-line-number="95">  putStrLn <span class="st">&quot;====&gt; Basic Syntax: Claim&quot;</span></a>
<a class="sourceLine" id="cb20-96" data-line-number="96">  testWith args <span class="fu">$</span> test_prettybasic (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">Claim</span>)</a>
<a class="sourceLine" id="cb20-97" data-line-number="97"></a>
<a class="sourceLine" id="cb20-98" data-line-number="98">  putStrLn <span class="st">&quot;====&gt; Basic Syntax: Module&quot;</span></a>
<a class="sourceLine" id="cb20-99" data-line-number="99">  testWith args <span class="fu">$</span> test_prettybasic (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> <span class="dt">Module</span>)</a></code></pre></div>
</body>
</html>
