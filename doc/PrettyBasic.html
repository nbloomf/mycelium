<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Basic Syntax</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="style.css">
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header>
<h1 class="title">Basic Syntax</h1>
</header>
<div class="sourceCode" id="cb1"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="ot">{-# LANGUAGE FlexibleInstances, FlexibleContexts, LambdaCase #-}</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">module</span> <span class="dt">PrettyBasic</span> <span class="kw">where</span></a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">import</span> <span class="dt">Data.List</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">  ( unwords, intercalate )</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.Map</span> <span class="kw">as</span> <span class="dt">M</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="kw">import</span> <span class="dt">Data.Proxy</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.Set</span> <span class="kw">as</span> <span class="dt">S</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="kw">import</span> <span class="dt">Text.ParserCombinators.Parsec</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="kw">import</span> <span class="dt">Text.ParserCombinators.Parsec.Expr</span></a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">import</span> <span class="dt">Var</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">import</span> <span class="dt">Sub</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw">import</span> <span class="dt">Expr</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="kw">import</span> <span class="dt">Type</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="kw">import</span> <span class="dt">Jud</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="kw">import</span> <span class="dt">Proof</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="kw">import</span> <span class="dt">Module</span></a></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="ot">spaceChars ::</span> <span class="dt">Parser</span> ()</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">spaceChars <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">  many <span class="fu">$</span> char <span class="ch">&#39; &#39;</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">  return ()</a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">class</span> <span class="dt">PrettyBasic</span> t <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="ot">  prettyBasic ::</span> t <span class="ot">-&gt;</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="ot">  prettyBasicWrap ::</span> t <span class="ot">-&gt;</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">  prettyBasicWrap t <span class="fu">=</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6">    <span class="kw">let</span> m <span class="fu">=</span> prettyBasic t <span class="kw">in</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7">    <span class="kw">if</span> (elem <span class="ch">&#39; &#39;</span> m) <span class="fu">||</span> (elem <span class="ch">&#39;.&#39;</span> m) <span class="fu">||</span> (elem <span class="ch">&#39;~&#39;</span> m) <span class="kw">then</span> <span class="st">&quot;(&quot;</span> <span class="fu">++</span> m <span class="fu">++</span> <span class="st">&quot;)&quot;</span> <span class="kw">else</span> m</a>
<a class="sourceLine" id="cb5-8" data-line-number="8"></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="ot">  parseBasic ::</span> <span class="dt">Parser</span> t</a></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb6-1" data-line-number="1">testBasicParser</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="ot">  ::</span> (<span class="dt">PrettyBasic</span> t) <span class="ot">=&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Either</span> <span class="dt">String</span> t</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">testBasicParser _ str <span class="fu">=</span> <span class="kw">case</span> runParser parseBasic () <span class="st">&quot;&quot;</span> str <span class="kw">of</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4">  <span class="dt">Left</span> err <span class="ot">-&gt;</span> <span class="dt">Left</span> <span class="fu">$</span> show err</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">  <span class="dt">Right</span> x <span class="ot">-&gt;</span> <span class="dt">Right</span> x</a></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb7-1" data-line-number="1">test_prettybasic</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="ot">  ::</span> (<span class="dt">PrettyBasic</span> t, <span class="dt">Eq</span> t) <span class="ot">=&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> t <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3">test_prettybasic _ t <span class="fu">=</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4">  <span class="kw">case</span> runParser parseBasic () <span class="st">&quot;&quot;</span> (prettyBasic t) <span class="kw">of</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">    <span class="dt">Left</span> err <span class="ot">-&gt;</span> error <span class="fu">$</span> show err</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">    <span class="dt">Right</span> u <span class="ot">-&gt;</span> t <span class="fu">==</span> u</a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">instance</span> <span class="dt">PrettyBasic</span> (<span class="dt">Var</span> <span class="dt">Expr</span>) <span class="kw">where</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">  prettyBasic (<span class="dt">Var</span> s) <span class="fu">=</span> s</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"></a>
<a class="sourceLine" id="cb8-4" data-line-number="4">  parseBasic <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5">    a <span class="ot">&lt;-</span> oneOf <span class="st">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6">    as <span class="ot">&lt;-</span> option <span class="st">&quot;&quot;</span> <span class="fu">$</span> many1 <span class="fu">$</span> oneOf <span class="st">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7">    bs <span class="ot">&lt;-</span> option <span class="st">&quot;&quot;</span> <span class="fu">$</span> many1 <span class="fu">$</span> oneOf <span class="st">&quot;0123456789&quot;</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8">    spaceChars</a>
<a class="sourceLine" id="cb8-9" data-line-number="9">    return (<span class="dt">Var</span> <span class="fu">$</span> a<span class="fu">:</span>as <span class="fu">++</span> bs)</a></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">instance</span> <span class="dt">PrettyBasic</span> (<span class="dt">Con</span> <span class="dt">Expr</span>) <span class="kw">where</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">  prettyBasic (<span class="dt">Con</span> s) <span class="fu">=</span> <span class="ch">&#39;\\&#39;</span> <span class="fu">:</span> s</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"></a>
<a class="sourceLine" id="cb9-4" data-line-number="4">  parseBasic <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5">    char <span class="ch">&#39;\\&#39;</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6">    a <span class="ot">&lt;-</span> oneOf <span class="st">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7">    as <span class="ot">&lt;-</span> option <span class="st">&quot;&quot;</span> <span class="fu">$</span> many1 <span class="fu">$</span> oneOf <span class="st">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8">    bs <span class="ot">&lt;-</span> option <span class="st">&quot;&quot;</span> <span class="fu">$</span> many1 <span class="fu">$</span> oneOf <span class="st">&quot;0123456789&quot;</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9">    spaceChars</a>
<a class="sourceLine" id="cb9-10" data-line-number="10">    return (<span class="dt">Con</span> <span class="fu">$</span> a<span class="fu">:</span>as <span class="fu">++</span> bs)</a></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">instance</span> <span class="dt">PrettyBasic</span> <span class="dt">Expr</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">  prettyBasic <span class="fu">=</span> \<span class="kw">case</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3">    <span class="dt">ECon</span> _ c <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4">      prettyBasic c</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">    <span class="dt">EVar</span> _ x <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6">      prettyBasic x</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">    <span class="dt">ELam</span> _ x e <span class="ot">-&gt;</span> concat</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">      [ <span class="st">&quot;λ&quot;</span>, prettyBasic x, <span class="st">&quot;.&quot;</span>, prettyBasicWrap e ]</a>
<a class="sourceLine" id="cb10-9" data-line-number="9">    <span class="dt">ELet</span> _ x f g <span class="ot">-&gt;</span> unwords</a>
<a class="sourceLine" id="cb10-10" data-line-number="10">      [ <span class="st">&quot;&#39;let&quot;</span>, prettyBasic x</a>
<a class="sourceLine" id="cb10-11" data-line-number="11">      , <span class="st">&quot;=&quot;</span>, prettyBasicWrap f</a>
<a class="sourceLine" id="cb10-12" data-line-number="12">      , <span class="st">&quot;&#39;in&quot;</span>, prettyBasicWrap g</a>
<a class="sourceLine" id="cb10-13" data-line-number="13">      ]</a>
<a class="sourceLine" id="cb10-14" data-line-number="14">    <span class="dt">EApp</span> _ e f <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15">      prettyBasicWrap e <span class="fu">++</span> <span class="st">&quot; &quot;</span> <span class="fu">++</span> prettyBasicWrap f</a>
<a class="sourceLine" id="cb10-16" data-line-number="16"></a>
<a class="sourceLine" id="cb10-17" data-line-number="17">  parseBasic <span class="fu">=</span> chainl1 parseForm (return (<span class="dt">EApp</span> <span class="dt">Q</span>))</a>
<a class="sourceLine" id="cb10-18" data-line-number="18">    <span class="kw">where</span></a>
<a class="sourceLine" id="cb10-19" data-line-number="19">      parseForm <span class="fu">=</span> try parseLam <span class="fu">&lt;|&gt;</span> try parseLet <span class="fu">&lt;|&gt;</span> try parseCon <span class="fu">&lt;|&gt;</span> try parseVar <span class="fu">&lt;|&gt;</span> fenced parseBasic</a>
<a class="sourceLine" id="cb10-20" data-line-number="20"></a>
<a class="sourceLine" id="cb10-21" data-line-number="21">      parseLam <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb10-22" data-line-number="22">        char <span class="ch">&#39;λ&#39;</span> <span class="fu">&gt;&gt;</span> spaceChars</a>
<a class="sourceLine" id="cb10-23" data-line-number="23">        x <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb10-24" data-line-number="24">        spaceChars <span class="fu">&gt;&gt;</span> char <span class="ch">&#39;.&#39;</span> <span class="fu">&gt;&gt;</span> spaceChars</a>
<a class="sourceLine" id="cb10-25" data-line-number="25">        e <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb10-26" data-line-number="26">        return <span class="fu">$</span> <span class="dt">ELam</span> <span class="dt">Q</span> x e</a>
<a class="sourceLine" id="cb10-27" data-line-number="27"></a>
<a class="sourceLine" id="cb10-28" data-line-number="28">      parseLet <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb10-29" data-line-number="29">        string <span class="st">&quot;&#39;let&quot;</span> <span class="fu">&gt;&gt;</span> spaceChars</a>
<a class="sourceLine" id="cb10-30" data-line-number="30">        x <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb10-31" data-line-number="31">        char <span class="ch">&#39;=&#39;</span> <span class="fu">&gt;&gt;</span> spaceChars</a>
<a class="sourceLine" id="cb10-32" data-line-number="32">        e1 <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb10-33" data-line-number="33">        string <span class="st">&quot;&#39;in&quot;</span> <span class="fu">&gt;&gt;</span> spaceChars</a>
<a class="sourceLine" id="cb10-34" data-line-number="34">        e2 <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb10-35" data-line-number="35">        return <span class="fu">$</span> <span class="dt">ELet</span> <span class="dt">Q</span> x e1 e2</a>
<a class="sourceLine" id="cb10-36" data-line-number="36"></a>
<a class="sourceLine" id="cb10-37" data-line-number="37">      parseCon <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb10-38" data-line-number="38">        c <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb10-39" data-line-number="39">        return (<span class="dt">ECon</span> <span class="dt">Q</span> c)</a>
<a class="sourceLine" id="cb10-40" data-line-number="40"></a>
<a class="sourceLine" id="cb10-41" data-line-number="41">      parseVar <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb10-42" data-line-number="42">        x <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb10-43" data-line-number="43">        return (<span class="dt">EVar</span> <span class="dt">Q</span> x)</a>
<a class="sourceLine" id="cb10-44" data-line-number="44"></a>
<a class="sourceLine" id="cb10-45" data-line-number="45">      fenced p <span class="fu">=</span></a>
<a class="sourceLine" id="cb10-46" data-line-number="46">            (between (char <span class="ch">&#39;(&#39;</span> <span class="fu">&gt;&gt;</span> spaceChars) (char <span class="ch">&#39;)&#39;</span> <span class="fu">&gt;&gt;</span> spaceChars) p)</a>
<a class="sourceLine" id="cb10-47" data-line-number="47">        <span class="fu">&lt;|&gt;</span> (between (char <span class="ch">&#39;{&#39;</span> <span class="fu">&gt;&gt;</span> spaceChars) (char <span class="ch">&#39;}&#39;</span> <span class="fu">&gt;&gt;</span> spaceChars) p)</a></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">instance</span> <span class="dt">PrettyBasic</span> (<span class="dt">Var</span> <span class="dt">MonoType</span>) <span class="kw">where</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">  prettyBasic (<span class="dt">Var</span> s) <span class="fu">=</span> s</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"></a>
<a class="sourceLine" id="cb11-4" data-line-number="4">  parseBasic <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5">    a <span class="ot">&lt;-</span> oneOf <span class="st">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6">    as <span class="ot">&lt;-</span> option <span class="st">&quot;&quot;</span> <span class="fu">$</span> many1 <span class="fu">$</span> oneOf <span class="st">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7">    bs <span class="ot">&lt;-</span> option <span class="st">&quot;&quot;</span> <span class="fu">$</span> many1 <span class="fu">$</span> oneOf <span class="st">&quot;0123456789&quot;</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8">    spaceChars</a>
<a class="sourceLine" id="cb11-9" data-line-number="9">    return (<span class="dt">Var</span> <span class="fu">$</span> a<span class="fu">:</span>as <span class="fu">++</span> bs)</a></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">instance</span> <span class="dt">PrettyBasic</span> (<span class="dt">Con</span> <span class="dt">MonoType</span>) <span class="kw">where</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">  prettyBasic (<span class="dt">Con</span> s) <span class="fu">=</span> s</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"></a>
<a class="sourceLine" id="cb12-4" data-line-number="4">  parseBasic <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5">    a <span class="ot">&lt;-</span> oneOf <span class="st">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6">    as <span class="ot">&lt;-</span> option <span class="st">&quot;&quot;</span> <span class="fu">$</span> many1 <span class="fu">$</span> oneOf <span class="st">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7">    bs <span class="ot">&lt;-</span> option <span class="st">&quot;&quot;</span> <span class="fu">$</span> many1 <span class="fu">$</span> oneOf <span class="st">&quot;0123456789&quot;</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8">    spaceChars</a>
<a class="sourceLine" id="cb12-9" data-line-number="9">    return (<span class="dt">Con</span> <span class="fu">$</span> a<span class="fu">:</span>as <span class="fu">++</span> bs)</a></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw">instance</span> <span class="dt">PrettyBasic</span> <span class="dt">MonoType</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">  prettyBasic <span class="fu">=</span> \<span class="kw">case</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3">    <span class="dt">TCon</span> _ c <span class="ot">-&gt;</span> prettyBasic c</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">    <span class="dt">TVar</span> _ x <span class="ot">-&gt;</span> prettyBasic x</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">    <span class="dt">TArr</span> _ a b <span class="ot">-&gt;</span> prettyBasicWrap a <span class="fu">++</span> <span class="st">&quot; -&gt; &quot;</span> <span class="fu">++</span> prettyBasic b</a>
<a class="sourceLine" id="cb13-6" data-line-number="6">    <span class="dt">TSt1</span> _ c a <span class="ot">-&gt;</span> prettyBasic c <span class="fu">++</span> <span class="st">&quot; &quot;</span> <span class="fu">++</span> prettyBasicWrap a</a>
<a class="sourceLine" id="cb13-7" data-line-number="7">    <span class="dt">TSt2</span> _ c a b <span class="ot">-&gt;</span> prettyBasic c <span class="fu">++</span> <span class="st">&quot; &quot;</span> <span class="fu">++</span> prettyBasicWrap a <span class="fu">++</span> <span class="st">&quot; &quot;</span> <span class="fu">++</span> prettyBasicWrap b</a>
<a class="sourceLine" id="cb13-8" data-line-number="8"></a>
<a class="sourceLine" id="cb13-9" data-line-number="9">  parseBasic <span class="fu">=</span> chainr1 (try parseF <span class="fu">&lt;|&gt;</span> parseForm) parseArr</a>
<a class="sourceLine" id="cb13-10" data-line-number="10">    <span class="kw">where</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11">      parseForm <span class="fu">=</span> try parseCon <span class="fu">&lt;|&gt;</span> try parseVar <span class="fu">&lt;|&gt;</span> fenced parseBasic</a>
<a class="sourceLine" id="cb13-12" data-line-number="12"></a>
<a class="sourceLine" id="cb13-13" data-line-number="13">      parseF <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14">        c <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb13-15" data-line-number="15">        option (<span class="dt">TCon</span> <span class="dt">Q</span> c) <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16">          x <span class="ot">&lt;-</span> parseForm</a>
<a class="sourceLine" id="cb13-17" data-line-number="17">          option (<span class="dt">TSt1</span> <span class="dt">Q</span> c x) <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb13-18" data-line-number="18">            y <span class="ot">&lt;-</span> parseForm</a>
<a class="sourceLine" id="cb13-19" data-line-number="19">            return <span class="fu">$</span> <span class="dt">TSt2</span> <span class="dt">Q</span> c x y</a>
<a class="sourceLine" id="cb13-20" data-line-number="20"></a>
<a class="sourceLine" id="cb13-21" data-line-number="21">      parseArr <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb13-22" data-line-number="22">        string <span class="st">&quot;-&gt;&quot;</span></a>
<a class="sourceLine" id="cb13-23" data-line-number="23">        spaceChars</a>
<a class="sourceLine" id="cb13-24" data-line-number="24">        return (<span class="dt">TArr</span> <span class="dt">Q</span>)</a>
<a class="sourceLine" id="cb13-25" data-line-number="25"></a>
<a class="sourceLine" id="cb13-26" data-line-number="26">      parseCon <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb13-27" data-line-number="27">        c <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb13-28" data-line-number="28">        return (<span class="dt">TCon</span> <span class="dt">Q</span> c)</a>
<a class="sourceLine" id="cb13-29" data-line-number="29"></a>
<a class="sourceLine" id="cb13-30" data-line-number="30">      parseVar <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb13-31" data-line-number="31">        x <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb13-32" data-line-number="32">        return (<span class="dt">TVar</span> <span class="dt">Q</span> x)</a>
<a class="sourceLine" id="cb13-33" data-line-number="33"></a>
<a class="sourceLine" id="cb13-34" data-line-number="34">      fenced p <span class="fu">=</span></a>
<a class="sourceLine" id="cb13-35" data-line-number="35">        (between (char <span class="ch">&#39;(&#39;</span> <span class="fu">&gt;&gt;</span> spaceChars) (char <span class="ch">&#39;)&#39;</span> <span class="fu">&gt;&gt;</span> spaceChars) p)</a></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">instance</span> <span class="dt">PrettyBasic</span> <span class="dt">PolyType</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">  prettyBasic (<span class="dt">ForAll</span> as tau) <span class="fu">=</span> <span class="st">&quot;∀ &quot;</span> <span class="fu">++</span> vars <span class="fu">++</span> <span class="st">&quot;. &quot;</span> <span class="fu">++</span> prettyBasic tau</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">    <span class="kw">where</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4">      vars <span class="fu">=</span> <span class="kw">if</span> S.null as</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">        <span class="kw">then</span> <span class="st">&quot;∅&quot;</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6">        <span class="kw">else</span> unwords <span class="fu">.</span> map prettyBasic <span class="fu">.</span> S.toList <span class="fu">$</span> as</a>
<a class="sourceLine" id="cb14-7" data-line-number="7"></a>
<a class="sourceLine" id="cb14-8" data-line-number="8">  parseBasic <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9">    char <span class="ch">&#39;∀&#39;</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10">    spaceChars</a>
<a class="sourceLine" id="cb14-11" data-line-number="11">    as <span class="ot">&lt;-</span> try parseNoVars <span class="fu">&lt;|&gt;</span> parseVars</a>
<a class="sourceLine" id="cb14-12" data-line-number="12">    char <span class="ch">&#39;.&#39;</span> <span class="fu">&gt;&gt;</span> spaceChars</a>
<a class="sourceLine" id="cb14-13" data-line-number="13">    tau <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb14-14" data-line-number="14">    return <span class="fu">$</span> <span class="dt">ForAll</span> as tau</a>
<a class="sourceLine" id="cb14-15" data-line-number="15">    <span class="kw">where</span></a>
<a class="sourceLine" id="cb14-16" data-line-number="16">      parseNoVars <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb14-17" data-line-number="17">        char <span class="ch">&#39;∅&#39;</span> <span class="fu">&gt;&gt;</span> spaceChars</a>
<a class="sourceLine" id="cb14-18" data-line-number="18">        return <span class="fu">$</span> S.empty</a>
<a class="sourceLine" id="cb14-19" data-line-number="19"></a>
<a class="sourceLine" id="cb14-20" data-line-number="20">      parseVars <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb14-21" data-line-number="21">        as <span class="ot">&lt;-</span> sepBy1 parseBasic spaceChars</a>
<a class="sourceLine" id="cb14-22" data-line-number="22">        spaceChars</a>
<a class="sourceLine" id="cb14-23" data-line-number="23">        return <span class="fu">$</span> S.fromList as</a></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">instance</span> <span class="dt">PrettyBasic</span> (<span class="dt">Sub</span> <span class="dt">Expr</span>) <span class="kw">where</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2">  prettyBasic (<span class="dt">Sub</span> m) <span class="fu">=</span> <span class="st">&quot;[&quot;</span> <span class="fu">++</span> (intercalate <span class="st">&quot;; &quot;</span> <span class="fu">$</span> map f <span class="fu">$</span> M.toList m) <span class="fu">++</span> <span class="st">&quot;]&quot;</span></a>
<a class="sourceLine" id="cb15-3" data-line-number="3">    <span class="kw">where</span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4">      f (x,e) <span class="fu">=</span> prettyBasic x <span class="fu">++</span> <span class="st">&quot; :-&gt; &quot;</span> <span class="fu">++</span> prettyBasic e</a>
<a class="sourceLine" id="cb15-5" data-line-number="5"></a>
<a class="sourceLine" id="cb15-6" data-line-number="6">  parseBasic <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7">    char <span class="ch">&#39;[&#39;</span> <span class="fu">&gt;&gt;</span> spaceChars</a>
<a class="sourceLine" id="cb15-8" data-line-number="8">    as <span class="ot">&lt;-</span> sepBy parseSub (char <span class="ch">&#39;;&#39;</span> <span class="fu">&gt;&gt;</span> spaceChars)</a>
<a class="sourceLine" id="cb15-9" data-line-number="9">    char <span class="ch">&#39;]&#39;</span> <span class="fu">&gt;&gt;</span> spaceChars</a>
<a class="sourceLine" id="cb15-10" data-line-number="10">    return <span class="fu">$</span> <span class="dt">Sub</span> <span class="fu">$</span> M.fromList as</a>
<a class="sourceLine" id="cb15-11" data-line-number="11">    <span class="kw">where</span></a>
<a class="sourceLine" id="cb15-12" data-line-number="12">      parseSub <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb15-13" data-line-number="13">        x <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb15-14" data-line-number="14">        string <span class="st">&quot;:-&gt;&quot;</span> <span class="fu">&gt;&gt;</span> spaceChars</a>
<a class="sourceLine" id="cb15-15" data-line-number="15">        e <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb15-16" data-line-number="16">        return (x,e)</a></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">instance</span> <span class="dt">PrettyBasic</span> (<span class="dt">Var</span> <span class="dt">Jud</span>) <span class="kw">where</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2">  prettyBasic (<span class="dt">Var</span> s) <span class="fu">=</span> s</a>
<a class="sourceLine" id="cb16-3" data-line-number="3"></a>
<a class="sourceLine" id="cb16-4" data-line-number="4">  parseBasic <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5">    a <span class="ot">&lt;-</span> oneOf <span class="st">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6">    as <span class="ot">&lt;-</span> option <span class="st">&quot;&quot;</span> <span class="fu">$</span> many1 <span class="fu">$</span> oneOf <span class="st">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7">    bs <span class="ot">&lt;-</span> option <span class="st">&quot;&quot;</span> <span class="fu">$</span> many1 <span class="fu">$</span> oneOf <span class="st">&quot;0123456789&quot;</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8">    spaceChars</a>
<a class="sourceLine" id="cb16-9" data-line-number="9">    return (<span class="dt">Var</span> <span class="fu">$</span> a<span class="fu">:</span>as <span class="fu">++</span> bs)</a></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">instance</span> <span class="dt">PrettyBasic</span> <span class="dt">Jud</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2">  prettyBasic <span class="fu">=</span> \<span class="kw">case</span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3">    <span class="dt">JVar</span> _ x <span class="ot">-&gt;</span> prettyBasic x</a>
<a class="sourceLine" id="cb17-4" data-line-number="4">    <span class="dt">JNeg</span> _ p <span class="ot">-&gt;</span> <span class="ch">&#39;~&#39;</span> <span class="fu">:</span> prettyBasicWrap p</a>
<a class="sourceLine" id="cb17-5" data-line-number="5">    <span class="dt">JConj</span> _ p q <span class="ot">-&gt;</span> concat</a>
<a class="sourceLine" id="cb17-6" data-line-number="6">      [ prettyBasicWrap p, <span class="st">&quot; /\\ &quot;</span>, prettyBasicWrap q ]</a>
<a class="sourceLine" id="cb17-7" data-line-number="7">    <span class="dt">JDisj</span> _ p q <span class="ot">-&gt;</span> concat</a>
<a class="sourceLine" id="cb17-8" data-line-number="8">      [ prettyBasicWrap p, <span class="st">&quot; \\/ &quot;</span>, prettyBasicWrap q ]</a>
<a class="sourceLine" id="cb17-9" data-line-number="9">    <span class="dt">JImpl</span> _ p q <span class="ot">-&gt;</span> concat</a>
<a class="sourceLine" id="cb17-10" data-line-number="10">      [ prettyBasicWrap p, <span class="st">&quot; =&gt; &quot;</span>, prettyBasicWrap q ]</a>
<a class="sourceLine" id="cb17-11" data-line-number="11">    <span class="dt">JEqui</span> _ p q <span class="ot">-&gt;</span> concat</a>
<a class="sourceLine" id="cb17-12" data-line-number="12">      [ prettyBasicWrap p, <span class="st">&quot; &lt;=&gt; &quot;</span>, prettyBasicWrap q ]</a>
<a class="sourceLine" id="cb17-13" data-line-number="13">    <span class="dt">JEq</span> _ e f <span class="ot">-&gt;</span> concat</a>
<a class="sourceLine" id="cb17-14" data-line-number="14">      [ prettyBasic e, <span class="st">&quot; == &quot;</span>, prettyBasic f ]</a>
<a class="sourceLine" id="cb17-15" data-line-number="15">    <span class="dt">JIs</span> _ e m <span class="ot">-&gt;</span> concat</a>
<a class="sourceLine" id="cb17-16" data-line-number="16">      [ prettyBasicWrap e, <span class="st">&quot; &#39;is &quot;</span>, <span class="st">&quot;\&quot;&quot;</span>, m, <span class="st">&quot;\&quot;&quot;</span> ]</a>
<a class="sourceLine" id="cb17-17" data-line-number="17">    <span class="dt">JAll</span> _ x p <span class="ot">-&gt;</span> concat</a>
<a class="sourceLine" id="cb17-18" data-line-number="18">      [ <span class="st">&quot;∀&quot;</span>, prettyBasic x, <span class="st">&quot;.&quot;</span>, prettyBasicWrap p ]</a>
<a class="sourceLine" id="cb17-19" data-line-number="19"></a>
<a class="sourceLine" id="cb17-20" data-line-number="20">  parseBasic <span class="fu">=</span> buildExpressionParser ops terms</a>
<a class="sourceLine" id="cb17-21" data-line-number="21">    <span class="kw">where</span></a>
<a class="sourceLine" id="cb17-22" data-line-number="22">      ops <span class="fu">=</span></a>
<a class="sourceLine" id="cb17-23" data-line-number="23">        [ [ <span class="dt">Prefix</span> (string <span class="st">&quot;~&quot;</span> <span class="fu">&gt;&gt;</span> spaceChars <span class="fu">&gt;&gt;</span> return (<span class="dt">JNeg</span> <span class="dt">Q</span>)) ]</a>
<a class="sourceLine" id="cb17-24" data-line-number="24">        , [ <span class="dt">Infix</span> (string <span class="st">&quot;/\\&quot;</span> <span class="fu">&gt;&gt;</span> spaceChars <span class="fu">&gt;&gt;</span> return (<span class="dt">JConj</span> <span class="dt">Q</span>)) <span class="dt">AssocNone</span> ]</a>
<a class="sourceLine" id="cb17-25" data-line-number="25">        , [ <span class="dt">Infix</span> (string <span class="st">&quot;\\/&quot;</span> <span class="fu">&gt;&gt;</span> spaceChars <span class="fu">&gt;&gt;</span> return (<span class="dt">JDisj</span> <span class="dt">Q</span>)) <span class="dt">AssocNone</span> ]</a>
<a class="sourceLine" id="cb17-26" data-line-number="26">        , [ <span class="dt">Infix</span> (string <span class="st">&quot;=&gt;&quot;</span> <span class="fu">&gt;&gt;</span> spaceChars <span class="fu">&gt;&gt;</span> return (<span class="dt">JImpl</span> <span class="dt">Q</span>)) <span class="dt">AssocNone</span> ]</a>
<a class="sourceLine" id="cb17-27" data-line-number="27">        , [ <span class="dt">Infix</span> (string <span class="st">&quot;&lt;=&gt;&quot;</span> <span class="fu">&gt;&gt;</span> spaceChars <span class="fu">&gt;&gt;</span> return (<span class="dt">JEqui</span> <span class="dt">Q</span>)) <span class="dt">AssocNone</span> ]</a>
<a class="sourceLine" id="cb17-28" data-line-number="28">        , [ <span class="dt">Prefix</span> <span class="fu">$</span> <span class="kw">do</span> char <span class="ch">&#39;∀&#39;</span>; spaceChars; x <span class="ot">&lt;-</span> parseBasic; char <span class="ch">&#39;.&#39;</span> <span class="fu">&gt;&gt;</span> spaceChars; return (<span class="dt">JAll</span> <span class="dt">Q</span> x) ]</a>
<a class="sourceLine" id="cb17-29" data-line-number="29">        ]</a>
<a class="sourceLine" id="cb17-30" data-line-number="30"></a>
<a class="sourceLine" id="cb17-31" data-line-number="31">      terms <span class="fu">=</span> try parseVar <span class="fu">&lt;|&gt;</span> try parseIs <span class="fu">&lt;|&gt;</span> try parseEq <span class="fu">&lt;|&gt;</span> fenced parseBasic</a>
<a class="sourceLine" id="cb17-32" data-line-number="32">        <span class="kw">where</span></a>
<a class="sourceLine" id="cb17-33" data-line-number="33">          parseVar <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb17-34" data-line-number="34">            x <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb17-35" data-line-number="35">            return (<span class="dt">JVar</span> <span class="dt">Q</span> x)</a>
<a class="sourceLine" id="cb17-36" data-line-number="36"></a>
<a class="sourceLine" id="cb17-37" data-line-number="37">          parseEq <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb17-38" data-line-number="38">            e <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb17-39" data-line-number="39">            string <span class="st">&quot;==&quot;</span> <span class="fu">&gt;&gt;</span> spaces</a>
<a class="sourceLine" id="cb17-40" data-line-number="40">            f <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb17-41" data-line-number="41">            return (<span class="dt">JEq</span> <span class="dt">Q</span> e f)</a>
<a class="sourceLine" id="cb17-42" data-line-number="42"></a>
<a class="sourceLine" id="cb17-43" data-line-number="43">          parseIs <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb17-44" data-line-number="44">            e <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb17-45" data-line-number="45">            string <span class="st">&quot;&#39;is&quot;</span> <span class="fu">&gt;&gt;</span> spaceChars</a>
<a class="sourceLine" id="cb17-46" data-line-number="46">            char <span class="ch">&#39;&quot;&#39;</span></a>
<a class="sourceLine" id="cb17-47" data-line-number="47">            m <span class="ot">&lt;-</span> many1 <span class="fu">$</span> oneOf _is_chars</a>
<a class="sourceLine" id="cb17-48" data-line-number="48">            char <span class="ch">&#39;&quot;&#39;</span> <span class="fu">&gt;&gt;</span> spaceChars</a>
<a class="sourceLine" id="cb17-49" data-line-number="49">            return (<span class="dt">JIs</span> <span class="dt">Q</span> e m)</a>
<a class="sourceLine" id="cb17-50" data-line-number="50"></a>
<a class="sourceLine" id="cb17-51" data-line-number="51">          fenced p <span class="fu">=</span></a>
<a class="sourceLine" id="cb17-52" data-line-number="52">            (between (char <span class="ch">&#39;(&#39;</span> <span class="fu">&gt;&gt;</span> spaceChars) (char <span class="ch">&#39;)&#39;</span> <span class="fu">&gt;&gt;</span> spaceChars) p)</a></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">instance</span> <span class="dt">PrettyBasic</span> <span class="dt">HypName</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2">  prettyBasic (<span class="dt">HypName</span> m) <span class="fu">=</span> m</a>
<a class="sourceLine" id="cb18-3" data-line-number="3"></a>
<a class="sourceLine" id="cb18-4" data-line-number="4">  parseBasic <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5">    n <span class="ot">&lt;-</span>  many1 <span class="fu">$</span> oneOf _hypname_chars</a>
<a class="sourceLine" id="cb18-6" data-line-number="6">    spaceChars</a>
<a class="sourceLine" id="cb18-7" data-line-number="7">    return <span class="fu">$</span> <span class="dt">HypName</span> n</a></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw">instance</span> <span class="dt">PrettyBasic</span> <span class="dt">RuleName</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2">  prettyBasic (<span class="dt">RuleName</span> m) <span class="fu">=</span> m</a>
<a class="sourceLine" id="cb19-3" data-line-number="3"></a>
<a class="sourceLine" id="cb19-4" data-line-number="4">  parseBasic <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5">    n <span class="ot">&lt;-</span> many1 <span class="fu">$</span> oneOf _rulename_chars</a>
<a class="sourceLine" id="cb19-6" data-line-number="6">    spaceChars</a>
<a class="sourceLine" id="cb19-7" data-line-number="7">    return <span class="fu">$</span> <span class="dt">RuleName</span> n</a></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">instance</span> <span class="dt">PrettyBasic</span> <span class="dt">Rule</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2">  prettyBasic (<span class="dt">Rule</span> q ps) <span class="fu">=</span> concat</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">    [ <span class="st">&quot;* &quot;</span>, prettyBasic q, <span class="st">&quot;\n&quot;</span> ]</a>
<a class="sourceLine" id="cb20-4" data-line-number="4">      <span class="fu">++</span> (concatMap (\p <span class="ot">-&gt;</span> concat [<span class="st">&quot;  * &quot;</span>, prettyBasic p, <span class="st">&quot;\n&quot;</span>]) ps)</a>
<a class="sourceLine" id="cb20-5" data-line-number="5"></a>
<a class="sourceLine" id="cb20-6" data-line-number="6">  parseBasic <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7">    char <span class="ch">&#39;*&#39;</span> <span class="fu">&gt;&gt;</span> spaceChars</a>
<a class="sourceLine" id="cb20-8" data-line-number="8">    q <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb20-9" data-line-number="9">    newline</a>
<a class="sourceLine" id="cb20-10" data-line-number="10">    ps <span class="ot">&lt;-</span> many <span class="fu">$</span> try <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11">      string <span class="st">&quot;  *&quot;</span> <span class="fu">&gt;&gt;</span> spaceChars</a>
<a class="sourceLine" id="cb20-12" data-line-number="12">      p <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb20-13" data-line-number="13">      newline</a>
<a class="sourceLine" id="cb20-14" data-line-number="14">      return p</a>
<a class="sourceLine" id="cb20-15" data-line-number="15">    return (<span class="dt">Rule</span> q ps)</a></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw">instance</span> <span class="dt">PrettyBasic</span> <span class="dt">Proof</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2">  prettyBasic <span class="fu">=</span> pretty <span class="dv">0</span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3">    <span class="kw">where</span></a>
<a class="sourceLine" id="cb21-4" data-line-number="4">      ind i <span class="fu">=</span> replicate (<span class="dv">2</span><span class="fu">*</span>i) <span class="ch">&#39; &#39;</span></a>
<a class="sourceLine" id="cb21-5" data-line-number="5"></a>
<a class="sourceLine" id="cb21-6" data-line-number="6">      pretty i <span class="fu">=</span> \<span class="kw">case</span></a>
<a class="sourceLine" id="cb21-7" data-line-number="7">        <span class="dt">Assume</span> k p <span class="ot">-&gt;</span> concat</a>
<a class="sourceLine" id="cb21-8" data-line-number="8">          [ ind i, <span class="st">&quot;* &quot;</span>, prettyBasic p, <span class="st">&quot; : assumption &quot;</span>, show k, <span class="st">&quot;\n&quot;</span> ]</a>
<a class="sourceLine" id="cb21-9" data-line-number="9">        <span class="dt">Hyp</span> name p <span class="ot">-&gt;</span> concat</a>
<a class="sourceLine" id="cb21-10" data-line-number="10">          [ ind i, <span class="st">&quot;* &quot;</span>, prettyBasic p, <span class="st">&quot; : hypothesis &quot;</span>, prettyBasic name, <span class="st">&quot;\n&quot;</span> ]</a>
<a class="sourceLine" id="cb21-11" data-line-number="11">        <span class="dt">Dis</span> name w pf <span class="ot">-&gt;</span> concat</a>
<a class="sourceLine" id="cb21-12" data-line-number="12">          [ ind i, <span class="st">&quot;* &quot;</span>, prettyBasic w, <span class="st">&quot; : discharge &quot;</span>, prettyBasic name, <span class="st">&quot;\n&quot;</span> ]</a>
<a class="sourceLine" id="cb21-13" data-line-number="13">            <span class="fu">++</span> pretty (i<span class="fu">+</span><span class="dv">1</span>) pf</a>
<a class="sourceLine" id="cb21-14" data-line-number="14">        <span class="dt">ElimEq</span> w x q pe pf <span class="ot">-&gt;</span> concat</a>
<a class="sourceLine" id="cb21-15" data-line-number="15">          [ ind i, <span class="st">&quot;* &quot;</span>, prettyBasic w, <span class="st">&quot; : eq-elim &quot;</span>, prettyBasic x, <span class="st">&quot; &quot;</span>, prettyBasic q, <span class="st">&quot;\n&quot;</span> ]</a>
<a class="sourceLine" id="cb21-16" data-line-number="16">            <span class="fu">++</span> pretty (i<span class="fu">+</span><span class="dv">1</span>) pe <span class="fu">++</span> pretty (i<span class="fu">+</span><span class="dv">1</span>) pf</a>
<a class="sourceLine" id="cb21-17" data-line-number="17">        <span class="dt">Subst</span> w s pf <span class="ot">-&gt;</span> concat</a>
<a class="sourceLine" id="cb21-18" data-line-number="18">          [ ind i, <span class="st">&quot;* &quot;</span>, prettyBasic w, <span class="st">&quot; : sub &quot;</span>, prettyBasic s, <span class="st">&quot;\n&quot;</span> ]</a>
<a class="sourceLine" id="cb21-19" data-line-number="19">            <span class="fu">++</span> pretty (i<span class="fu">+</span><span class="dv">1</span>) pf</a>
<a class="sourceLine" id="cb21-20" data-line-number="20">        <span class="dt">IntroU</span> w x y pf <span class="ot">-&gt;</span> concat</a>
<a class="sourceLine" id="cb21-21" data-line-number="21">          [ ind i, <span class="st">&quot;* &quot;</span>, prettyBasic w, <span class="st">&quot; : forall-intro &quot;</span>, prettyBasic x, <span class="st">&quot; -&gt; &quot;</span>, prettyBasic y, <span class="st">&quot;\n&quot;</span> ]</a>
<a class="sourceLine" id="cb21-22" data-line-number="22">            <span class="fu">++</span> pretty (i<span class="fu">+</span><span class="dv">1</span>) pf</a>
<a class="sourceLine" id="cb21-23" data-line-number="23">        <span class="dt">ElimU</span> w x e pf <span class="ot">-&gt;</span> concat</a>
<a class="sourceLine" id="cb21-24" data-line-number="24">          [ ind i, <span class="st">&quot;* &quot;</span>, prettyBasic w, <span class="st">&quot; : forall-elim &quot;</span>, prettyBasic x, <span class="st">&quot; -&gt; &quot;</span>, prettyBasic e, <span class="st">&quot;\n&quot;</span> ]</a>
<a class="sourceLine" id="cb21-25" data-line-number="25">            <span class="fu">++</span> pretty (i<span class="fu">+</span><span class="dv">1</span>) pf</a>
<a class="sourceLine" id="cb21-26" data-line-number="26">        <span class="dt">Use</span> name q pfs <span class="ot">-&gt;</span> concat</a>
<a class="sourceLine" id="cb21-27" data-line-number="27">          [ ind i, <span class="st">&quot;* &quot;</span>, prettyBasic q, <span class="st">&quot; : use &quot;</span>, prettyBasic name, <span class="st">&quot;\n&quot;</span> ]</a>
<a class="sourceLine" id="cb21-28" data-line-number="28">            <span class="fu">++</span> (concatMap (pretty (i<span class="fu">+</span><span class="dv">1</span>)) pfs)</a>
<a class="sourceLine" id="cb21-29" data-line-number="29"></a>
<a class="sourceLine" id="cb21-30" data-line-number="30">  parseBasic <span class="fu">=</span> p <span class="dv">0</span></a>
<a class="sourceLine" id="cb21-31" data-line-number="31">    <span class="kw">where</span></a>
<a class="sourceLine" id="cb21-32" data-line-number="32">      p i <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb21-33" data-line-number="33">        count (<span class="dv">2</span><span class="fu">*</span>i) (char <span class="ch">&#39; &#39;</span>)</a>
<a class="sourceLine" id="cb21-34" data-line-number="34">        char <span class="ch">&#39;*&#39;</span> <span class="fu">&gt;&gt;</span> spaceChars</a>
<a class="sourceLine" id="cb21-35" data-line-number="35">        q <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb21-36" data-line-number="36">        char <span class="ch">&#39;:&#39;</span> <span class="fu">&gt;&gt;</span> spaceChars</a>
<a class="sourceLine" id="cb21-37" data-line-number="37">        just <span class="ot">&lt;-</span> many1 <span class="fu">$</span> oneOf <span class="st">&quot;abcdefghijklmnopqrstuvwxyz-&quot;</span></a>
<a class="sourceLine" id="cb21-38" data-line-number="38">        spaceChars</a>
<a class="sourceLine" id="cb21-39" data-line-number="39">        <span class="kw">case</span> just <span class="kw">of</span></a>
<a class="sourceLine" id="cb21-40" data-line-number="40">          <span class="st">&quot;assumption&quot;</span> <span class="ot">-&gt;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb21-41" data-line-number="41">            k <span class="ot">&lt;-</span> read <span class="fu">&lt;$&gt;</span> many1 digit</a>
<a class="sourceLine" id="cb21-42" data-line-number="42">            newline</a>
<a class="sourceLine" id="cb21-43" data-line-number="43">            return (<span class="dt">Assume</span> k q)</a>
<a class="sourceLine" id="cb21-44" data-line-number="44"></a>
<a class="sourceLine" id="cb21-45" data-line-number="45">          <span class="st">&quot;hypothesis&quot;</span> <span class="ot">-&gt;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb21-46" data-line-number="46">            n <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb21-47" data-line-number="47">            newline</a>
<a class="sourceLine" id="cb21-48" data-line-number="48">            return (<span class="dt">Hyp</span> n q)</a>
<a class="sourceLine" id="cb21-49" data-line-number="49"></a>
<a class="sourceLine" id="cb21-50" data-line-number="50">          <span class="st">&quot;discharge&quot;</span> <span class="ot">-&gt;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb21-51" data-line-number="51">            n <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb21-52" data-line-number="52">            newline</a>
<a class="sourceLine" id="cb21-53" data-line-number="53">            pf <span class="ot">&lt;-</span> p (i<span class="fu">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb21-54" data-line-number="54">            return (<span class="dt">Dis</span> n q pf)</a>
<a class="sourceLine" id="cb21-55" data-line-number="55"></a>
<a class="sourceLine" id="cb21-56" data-line-number="56">          <span class="st">&quot;eq-elim&quot;</span> <span class="ot">-&gt;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb21-57" data-line-number="57">            x <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb21-58" data-line-number="58">            spaceChars</a>
<a class="sourceLine" id="cb21-59" data-line-number="59">            w <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb21-60" data-line-number="60">            newline</a>
<a class="sourceLine" id="cb21-61" data-line-number="61">            pe <span class="ot">&lt;-</span> p (i<span class="fu">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb21-62" data-line-number="62">            pf <span class="ot">&lt;-</span> p (i<span class="fu">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb21-63" data-line-number="63">            return (<span class="dt">ElimEq</span> q x w pe pf)</a>
<a class="sourceLine" id="cb21-64" data-line-number="64"></a>
<a class="sourceLine" id="cb21-65" data-line-number="65">          <span class="st">&quot;sub&quot;</span> <span class="ot">-&gt;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb21-66" data-line-number="66">            s <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb21-67" data-line-number="67">            newline</a>
<a class="sourceLine" id="cb21-68" data-line-number="68">            pf <span class="ot">&lt;-</span> p (i<span class="fu">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb21-69" data-line-number="69">            return (<span class="dt">Subst</span> q s pf)</a>
<a class="sourceLine" id="cb21-70" data-line-number="70"></a>
<a class="sourceLine" id="cb21-71" data-line-number="71">          <span class="st">&quot;forall-intro&quot;</span> <span class="ot">-&gt;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb21-72" data-line-number="72">            x <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb21-73" data-line-number="73">            string <span class="st">&quot;-&gt;&quot;</span> <span class="fu">&gt;&gt;</span> spaceChars</a>
<a class="sourceLine" id="cb21-74" data-line-number="74">            y <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb21-75" data-line-number="75">            newline</a>
<a class="sourceLine" id="cb21-76" data-line-number="76">            pf <span class="ot">&lt;-</span> p (i<span class="fu">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb21-77" data-line-number="77">            return (<span class="dt">IntroU</span> q x y pf)</a>
<a class="sourceLine" id="cb21-78" data-line-number="78"></a>
<a class="sourceLine" id="cb21-79" data-line-number="79">          <span class="st">&quot;forall-elim&quot;</span> <span class="ot">-&gt;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb21-80" data-line-number="80">            x <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb21-81" data-line-number="81">            string <span class="st">&quot;-&gt;&quot;</span> <span class="fu">&gt;&gt;</span> spaceChars</a>
<a class="sourceLine" id="cb21-82" data-line-number="82">            e <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb21-83" data-line-number="83">            newline</a>
<a class="sourceLine" id="cb21-84" data-line-number="84">            pf <span class="ot">&lt;-</span> p (i<span class="fu">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb21-85" data-line-number="85">            return (<span class="dt">ElimU</span> q x e pf)</a>
<a class="sourceLine" id="cb21-86" data-line-number="86"></a>
<a class="sourceLine" id="cb21-87" data-line-number="87">          <span class="st">&quot;use&quot;</span> <span class="ot">-&gt;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb21-88" data-line-number="88">            n <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb21-89" data-line-number="89">            newline</a>
<a class="sourceLine" id="cb21-90" data-line-number="90">            pfs <span class="ot">&lt;-</span> many <span class="fu">$</span> try <span class="fu">$</span> p (i<span class="fu">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb21-91" data-line-number="91">            return (<span class="dt">Use</span> n q pfs)</a>
<a class="sourceLine" id="cb21-92" data-line-number="92"></a>
<a class="sourceLine" id="cb21-93" data-line-number="93">          _ <span class="ot">-&gt;</span> error <span class="st">&quot;unrecognized justification&quot;</span></a></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">instance</span> <span class="dt">PrettyBasic</span> <span class="dt">Claim</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2">  prettyBasic <span class="fu">=</span> \<span class="kw">case</span></a>
<a class="sourceLine" id="cb22-3" data-line-number="3">    <span class="dt">Axiom</span> n ax <span class="ot">-&gt;</span> concat</a>
<a class="sourceLine" id="cb22-4" data-line-number="4">      [ <span class="st">&quot;rule &quot;</span>, prettyBasic n, <span class="st">&quot;\n&quot;</span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5">      , prettyBasic ax, <span class="st">&quot;\n&quot;</span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6">      ]</a>
<a class="sourceLine" id="cb22-7" data-line-number="7">    <span class="dt">Theorem</span> n t pf <span class="ot">-&gt;</span> concat</a>
<a class="sourceLine" id="cb22-8" data-line-number="8">      [ <span class="st">&quot;theorem &quot;</span>, prettyBasic n, <span class="st">&quot;\n&quot;</span></a>
<a class="sourceLine" id="cb22-9" data-line-number="9">      , prettyBasic t, <span class="st">&quot;\n&quot;</span></a>
<a class="sourceLine" id="cb22-10" data-line-number="10">      , <span class="st">&quot;proof\n&quot;</span>, prettyBasic pf, <span class="st">&quot;\n&quot;</span></a>
<a class="sourceLine" id="cb22-11" data-line-number="11">      ]</a>
<a class="sourceLine" id="cb22-12" data-line-number="12">    <span class="dt">TypeDecl</span> c t <span class="ot">-&gt;</span> concat</a>
<a class="sourceLine" id="cb22-13" data-line-number="13">      [ <span class="st">&quot;type &quot;</span>, prettyBasic c, <span class="st">&quot; :: &quot;</span>, prettyBasic t, <span class="st">&quot;\n&quot;</span> ]</a>
<a class="sourceLine" id="cb22-14" data-line-number="14"></a>
<a class="sourceLine" id="cb22-15" data-line-number="15">  parseBasic <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb22-16" data-line-number="16">    m <span class="ot">&lt;-</span> many1 <span class="fu">$</span> oneOf <span class="st">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span></a>
<a class="sourceLine" id="cb22-17" data-line-number="17">    spaceChars</a>
<a class="sourceLine" id="cb22-18" data-line-number="18">    <span class="kw">case</span> m <span class="kw">of</span></a>
<a class="sourceLine" id="cb22-19" data-line-number="19">      <span class="st">&quot;rule&quot;</span> <span class="ot">-&gt;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb22-20" data-line-number="20">        n <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb22-21" data-line-number="21">        newline</a>
<a class="sourceLine" id="cb22-22" data-line-number="22">        ax <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb22-23" data-line-number="23">        many newline</a>
<a class="sourceLine" id="cb22-24" data-line-number="24">        return (<span class="dt">Axiom</span> n ax)</a>
<a class="sourceLine" id="cb22-25" data-line-number="25"></a>
<a class="sourceLine" id="cb22-26" data-line-number="26">      <span class="st">&quot;theorem&quot;</span> <span class="ot">-&gt;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb22-27" data-line-number="27">        n <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb22-28" data-line-number="28">        many1 newline</a>
<a class="sourceLine" id="cb22-29" data-line-number="29">        r <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb22-30" data-line-number="30">        many newline</a>
<a class="sourceLine" id="cb22-31" data-line-number="31">        string <span class="st">&quot;proof&quot;</span> <span class="fu">&gt;&gt;</span> spaceChars</a>
<a class="sourceLine" id="cb22-32" data-line-number="32">        many1 newline</a>
<a class="sourceLine" id="cb22-33" data-line-number="33">        p <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb22-34" data-line-number="34">        many newline</a>
<a class="sourceLine" id="cb22-35" data-line-number="35">        return (<span class="dt">Theorem</span> n r p)</a>
<a class="sourceLine" id="cb22-36" data-line-number="36"></a>
<a class="sourceLine" id="cb22-37" data-line-number="37">      <span class="st">&quot;type&quot;</span> <span class="ot">-&gt;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb22-38" data-line-number="38">        c <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb22-39" data-line-number="39">        string <span class="st">&quot;::&quot;</span> <span class="fu">&gt;&gt;</span> spaceChars</a>
<a class="sourceLine" id="cb22-40" data-line-number="40">        t <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb22-41" data-line-number="41">        many newline</a>
<a class="sourceLine" id="cb22-42" data-line-number="42">        return (<span class="dt">TypeDecl</span> c t)</a>
<a class="sourceLine" id="cb22-43" data-line-number="43"></a>
<a class="sourceLine" id="cb22-44" data-line-number="44">      _ <span class="ot">-&gt;</span> error <span class="st">&quot;claim parse&quot;</span></a></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">instance</span> <span class="dt">PrettyBasic</span> <span class="dt">ModuleName</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2">  prettyBasic (<span class="dt">ModuleName</span> n) <span class="fu">=</span> n</a>
<a class="sourceLine" id="cb23-3" data-line-number="3"></a>
<a class="sourceLine" id="cb23-4" data-line-number="4">  parseBasic <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb23-5" data-line-number="5">    n <span class="ot">&lt;-</span> many1 <span class="fu">$</span> oneOf <span class="st">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-_@&quot;</span></a>
<a class="sourceLine" id="cb23-6" data-line-number="6">    spaceChars</a>
<a class="sourceLine" id="cb23-7" data-line-number="7">    return (<span class="dt">ModuleName</span> n)</a></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">instance</span> <span class="dt">PrettyBasic</span> <span class="dt">Module</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2">  prettyBasic (<span class="dt">Module</span> n m) <span class="fu">=</span> concat</a>
<a class="sourceLine" id="cb24-3" data-line-number="3">    [ <span class="st">&quot;module &quot;</span>, prettyBasic n, <span class="st">&quot;\n\n&quot;</span>, concatMap prettyBasic m ]</a>
<a class="sourceLine" id="cb24-4" data-line-number="4"></a>
<a class="sourceLine" id="cb24-5" data-line-number="5">  parseBasic <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb24-6" data-line-number="6">    string <span class="st">&quot;module&quot;</span> <span class="fu">&gt;&gt;</span> spaceChars</a>
<a class="sourceLine" id="cb24-7" data-line-number="7">    n <span class="ot">&lt;-</span> parseBasic</a>
<a class="sourceLine" id="cb24-8" data-line-number="8">    many1 newline</a>
<a class="sourceLine" id="cb24-9" data-line-number="9">    m <span class="ot">&lt;-</span> many parseBasic</a>
<a class="sourceLine" id="cb24-10" data-line-number="10">    eof</a>
<a class="sourceLine" id="cb24-11" data-line-number="11">    return (<span class="dt">Module</span> n m)</a></code></pre></div>
</body>
</html>
